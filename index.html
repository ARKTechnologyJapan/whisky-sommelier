<!DOCTYPE html>
<!-- saved from url=(0139)https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/tooluse__AxdTB_gTBmnfKQ22kX4XA/whisky_sommelier_complete_final.html -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êòº„ÅÆÊúà„ÄÇAI„ÇΩ„É†„É™„Ç®</title>
    <link href="./index_files/tailwind.min.css" rel="stylesheet">
    <script src="./index_files/chart.js.„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ"></script>
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Noto Sans JP', sans-serif;
        }
        .header-container {
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .logo {
            width: 50px;
            height: 50px;
            position: absolute;
            left: 20px;
            border-radius: 8px;
        }
        .header-title {
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
        }
        .container-custom {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 20px 20px;
        }
        .taste-matrix {
            width: 400px;
            height: 400px;
            border: 2px solid #fff;
            position: relative;
            background: linear-gradient(to right, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 50%, rgba(255,255,255,0.1) 100%), 
                        linear-gradient(to top, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 50%, rgba(255,255,255,0.1) 100%);
        }
        .taste-dot {
            width: 20px;
            height: 20px;
            background-color: #ff6b6b;
            border-radius: 50%;
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }
        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
        }
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            backdrop-filter: blur(10px);
        }
        .whisky-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .whisky-card:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: #4ecdc4;
            transform: translateY(-2px);
        }
        .whisky-card.selected {
            background: rgba(78, 205, 196, 0.15);
            border-color: #4ecdc4;
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.3);
        }
        .whisky-card.recommended {
            background: rgba(255, 165, 0, 0.15);
            border: 2px solid #ffa500;
            box-shadow: 0 0 20px rgba(255, 165, 0, 0.4);
        }
        .whisky-card.recommended .whisky-name {
            color: #ffa500;
            font-weight: bold;
        }
        .whisky-card.recommended::before {
            content: "üåü „Åä„Åô„Åô„ÇÅ";
            position: absolute;
            top: -8px;
            right: 10px;
            background: #ffa500;
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        .loading {
            display: none;
            text-align: center;
            color: #4ecdc4;
        }
        .progress-container {
            display: none;
            margin-top: 20px;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            width: 0%;
            transition: width 0.3s ease;
        }
        .progress-text {
            color: #4ecdc4;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .progress-percentage {
            color: #fff;
            font-size: 16px;
            font-weight: bold;
        }
        .error {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
        }
        .success {
            color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
        }
        .price-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            margin: 10px 0;
        }
        .price-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4ecdc4;
            cursor: pointer;
        }
        .price-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4ecdc4;
            cursor: pointer;
            border: none;
        }
        .axis-controls {
            margin-bottom: 30px;
        }
        .taste-matrix-container {
            margin-top: 20px;
        }
        .voice-input-btn {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid #4ecdc4;
            color: #4ecdc4;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .voice-input-btn:hover {
            background: rgba(78, 205, 196, 0.3);
        }
        .voice-input-btn.recording {
            background: rgba(255, 107, 107, 0.3);
            border-color: #ff6b6b;
            color: #ff6b6b;
            animation: pulse 1s infinite;
        }
        .voice-input-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .split-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: start;
        }
        .recommendations-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            backdrop-filter: blur(10px);
            max-height: 80vh;
            overflow-y: auto;
        }
        .chart-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            position: sticky;
            top: 120px;
        }
        .chart-container {
            height: 500px;
            width: 100%;
            position: relative;
        }
        .chart-container h3 {
            text-align: center;
            margin-bottom: 20px;
            color: #4ecdc4;
            font-size: 16px;
        }
        .chart-canvas {
            height: 400px !important;
            width: 100% !important;
        }
        #combinedProfileChart {
            height: 400px !important;
            width: 100% !important;
        }
        .recommendation-summary {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
            color: #4ecdc4;
        }
        .custom-footer {
            display: none;
            text-align: center;
            padding: 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            margin-top: 40px;
        }
        .svg-icon {
            width: 20px;
            height: 20px;
            fill: currentColor;
            display: inline-block;
            vertical-align: middle;
        }
        .json-manager {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .json-input {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: white;
            margin: 10px 0;
        }
        .json-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        @media (max-width: 1024px) {
            .split-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .chart-panel {
                position: static;
            }
        }
        @media (max-width: 768px) {
            .custom-footer {
                display: block;
            }
        }
        .recommendations-panel::-webkit-scrollbar {
            width: 8px;
        }
        .recommendations-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        .recommendations-panel::-webkit-scrollbar-thumb {
            background: rgba(78, 205, 196, 0.5);
            border-radius: 4px;
        }
        .recommendations-panel::-webkit-scrollbar-thumb:hover {
            background: rgba(78, 205, 196, 0.7);
        }
    </style>
<style>
    .genspark-notice-dialog {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .genspark-notice-content {
      background-color: white;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-sizing: border-box;
      padding: 10px 30px 30px 30px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    .genspark-notice-title {
      color: #000;
      font-family: Arial;
      font-size: 20px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 
    }

    .genspark-notice-list {
      margin: 24px 0;
      
      color: #606366;
      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 150%;
      padding-left: 12px;
    }

    .genspark-notice-list li {
      margin-bottom: 12px;
      list-style-type: disc;
    }

    .genspark-notice-list li a {
      color: #606366;
      text-decoration: underline;
    }

    .genspark-notice-checkbox {
      display: flex;
      align-items: center;
      margin-top: 20px;
      gap: 10px;

      color: #232425;

      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: normal;
    }

    .genspark-notice-actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
      
    .genspark-notice-ok {
      color: #232425;

      text-align: center;
      font-family: Arial;
      font-size: 16px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 

      cursor: pointer;
      display: flex;
      height: 40px;
      padding: 6px 14px;
      justify-content: center;
      align-items: center;
      gap: 10px;
      align-self: stretch;
      border-radius: 8px;
      border: 1px solid #000;
      box-sizing: border-box;
      width: 100%;
    }
  </style></head>
<body>
    <div class="header-container">
        <svg class="logo" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
            <circle cx="25" cy="25" r="20" stroke="#4ecdc4" stroke-width="2" fill="none"></circle>
            <text x="25" y="30" text-anchor="middle" fill="#4ecdc4" font-size="12">Êòº„ÅÆÊúà</text>
        </svg>
        <h1 class="header-title">Êòº„ÅÆÊúà„ÄÇAI„ÇΩ„É†„É™„Ç®</h1>
    </div>
    
    <div class="container-custom">
        <p class="text-center text-gray-300 mb-8">„ÅÇ„Å™„Åü„ÅÆÂ•Ω„Åø„Å´Âêà„Çè„Åõ„ÅüÊúÄÈÅ©„Å™„Ç¶„Ç£„Çπ„Ç≠„Éº„ÇíAI„ÅåÊèêÊ°à„Åó„Åæ„Åô</p>
        
        <!-- JSON „Éá„Éº„ÇøÁÆ°ÁêÜ -->
        <div class="json-manager">
            <h2 class="text-xl font-bold mb-4">
                <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                    <path d="M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4c0-1.11.89-2 2-2m5 2H6v16h12v-9h-7V4z"></path>
                </svg>
                „Ç¶„Ç£„Çπ„Ç≠„Éº„Éá„Éº„ÇøÁÆ°ÁêÜ
            </h2>
            <p class="text-sm text-gray-400 mb-4">Â§ñÈÉ®JSON„Éï„Ç°„Ç§„É´„Åã„Çâ„Ç¶„Ç£„Çπ„Ç≠„Éº„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø</p>
            <div class="flex gap-4 mb-4">
                <button id="loadJsonFile" class="btn-secondary">
                    <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"></path>
                    </svg>
                    JSON„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû
                </button>
                <button id="loadFromUrl" class="btn-secondary">
                    <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                        <path d="M16.36,14C16.44,13.34 16.5,12.68 16.5,12C16.5,11.32 16.44,10.66 16.36,10H19.74C19.9,10.64 20,11.31 20,12C20,12.69 19.9,13.36 19.74,14M14.59,19.56C15.19,18.45 15.65,17.25 15.97,16H18.92C17.96,17.65 16.43,18.93 14.59,19.56M14.34,14H9.66C9.56,13.34 9.5,12.68 9.5,12C9.5,11.32 9.56,10.65 9.66,10H14.34C14.43,10.65 14.5,11.32 14.5,12C14.5,12.68 14.43,13.34 14.34,14M12,19.96C11.17,18.76 10.5,17.43 10.09,16H13.91C13.5,17.43 12.83,18.76 12,19.96M8,8H5.08C6.03,6.34 7.57,5.06 9.4,4.44C8.8,5.55 8.35,6.75 8,8M5.08,16H8C8.35,17.25 8.8,18.45 9.4,19.56C7.57,18.93 6.03,17.65 5.08,16M4.26,14C4.1,13.36 4,12.69 4,12C4,11.31 4.1,10.64 4.26,10H7.64C7.56,10.66 7.5,11.32 7.5,12C7.5,12.68 7.56,13.34 7.64,14M12,4.03C12.83,5.23 13.5,6.57 13.91,8H10.09C10.5,6.57 11.17,5.23 12,4.03M18.92,8H15.97C15.65,6.75 15.19,5.55 14.59,4.44C16.43,5.07 17.96,6.34 18.92,8Z"></path>
                    </svg>
                    Â§ñÈÉ®JSON„Åã„ÇâË™≠„ÅøËæº„Åø
                </button>
            </div>
            <input type="text" id="jsonUrl" class="json-input" placeholder="https://example.com/whisky-data.json" style="display: none;">
            <input type="file" id="jsonFileInput" accept=".json" style="display: none;">
            <div id="dataStatus" class="text-sm text-green-400">‚úÖ 2 ‰ª∂„ÅÆ„Ç¶„Ç£„Çπ„Ç≠„Éº„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÅøÊ∏à„Åø</div>
        </div>
        
        <div class="card">
            <h2 class="text-2xl font-bold mb-4">
                <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                    <path d="M7,15H9C9,16.08 9.37,17 10,17C10.63,17 11,16.08 11,15C11,13.9 10.36,13.5 9.91,13.11C9.66,12.95 9.5,12.82 9.5,12.6C9.5,12.28 9.78,12 10.1,12H11.9C12.22,12 12.5,12.28 12.5,12.6C12.5,12.82 12.34,12.95 12.09,13.11C11.64,13.5 11,13.9 11,15C11,16.08 11.37,17 12,17C12.63,17 13,16.08 13,15H15C15,17.21 13.21,19 11,19C8.79,19 7,17.21 7,15M9,5V7H15V5H9M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z"></path>
                </svg>
                ‰æ°Ê†ºÂ∏ØË®≠ÂÆö
            </h2>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block mb-2">‰∏ãÈôê‰æ°Ê†º: <span id="minPriceDisplay">¬•1,000</span></label>
                    <input type="range" id="minPrice" class="price-slider" min="1" max="80" value="1" step="1">
                </div>
                <div>
                    <label class="block mb-2">‰∏äÈôê‰æ°Ê†º: <span id="maxPriceDisplay">¬•80,000</span></label>
                    <input type="range" id="maxPrice" class="price-slider" min="1" max="80" value="80" step="1">
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="text-2xl font-bold mb-4">
                <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                    <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"></path>
                </svg>
                Âë≥Ë¶ö„Éó„É≠„Éï„Ç°„Ç§„É´Ë®≠ÂÆö
            </h2>
            <div class="axis-controls">
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block mb-2">XËª∏Ôºö</label>
                        <select id="xAxis" class="w-full p-2 bg-gray-800 border border-gray-600 rounded">
                            <option value="light-heavy">„É©„Ç§„Éà ‚Üî „Éò„Éì„Éº</option>
                            <option value="sweet-dry">„Çπ„Ç§„Éº„Éà ‚Üî „Éâ„É©„Ç§</option>
                            <option value="young-aged">Ëã•„ÅÑ ‚Üî ÁÜüÊàê</option>
                        </select>
                    </div>
                    <div>
                        <label class="block mb-2">YËª∏Ôºö</label>
                        <select id="yAxis" class="w-full p-2 bg-gray-800 border border-gray-600 rounded">
                            <option value="fruity-smoky">„Éï„É´„Éº„ÉÜ„Ç£„Éº ‚Üî „Çπ„É¢„Éº„Ç≠„Éº</option>
                            <option value="mild-strong">„Åæ„Çç„ÇÑ„Åã ‚Üî Âº∑ÁÉà</option>
                            <option value="floral-peaty">„Éï„É≠„Éº„É©„É´ ‚Üî „Éî„Éº„Éà</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="taste-matrix-container">
                <p class="mb-4">ÂõõËßíÂÜÖ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Â•Ω„Åø„ÅÆ‰ΩçÁΩÆ„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                <div class="flex justify-center">
                    <div class="relative">
                        <div class="taste-matrix" id="tasteMatrix">
                            <div class="taste-dot" id="tasteDot" style="left: 50%; top: 50%;"></div>
                        </div>
                        <div class="absolute -top-8 left-1/2 transform -translate-x-1/2 text-sm" id="topLabel">„Éï„É´„Éº„ÉÜ„Ç£„Éº</div>
                        <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-sm" id="bottomLabel">„Çπ„É¢„Éº„Ç≠„Éº</div>
                        <div class="absolute -left-16 top-1/2 transform -translate-y-1/2 text-sm" id="leftLabel">„É©„Ç§„Éà</div>
                        <div class="absolute -right-16 top-1/2 transform -translate-y-1/2 text-sm" id="rightLabel">„Éò„Éì„Éº</div>
                    </div>
                </div>
                <div class="text-center mt-8">
                    <span id="coordinates" class="text-sm text-gray-400">Â∫ßÊ®ô: X: 0.5, Y: 0.5</span>
                </div>
            </div>
            
            <div class="mt-6">
                <h3 class="text-lg font-bold mb-2">ËøΩÂä†„ÅÆÂ•Ω„Åø„ÇÑË¶ÅÊúõ</h3>
                <div class="flex gap-2">
                    <textarea id="additionalPreferences" class="flex-1 p-3 bg-gray-800 border border-gray-600 rounded-lg" placeholder="‰æãÔºö„Éê„Éã„É©„Åå„ÅÇ„Çã„ÄÅÁîò„ÅÑÊÑü„Åò„ÅÆÂë≥„Åå„ÅÑ„ÅÑ„ÄÇ"></textarea>
                    <button id="voiceInputBtn" class="voice-input-btn">
                        <svg class="svg-icon" viewBox="0 0 24 24">
                            <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"></path>
                        </svg>
                        <span id="voiceButtonText">Èü≥Â£∞ÂÖ•Âäõ</span>
                    </button>
                </div>
                <div id="voiceStatus" class="text-sm text-gray-400 mt-2">„Éû„Ç§„ÇØ„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Èü≥Â£∞ÂÖ•Âäõ„ÇíÈñãÂßã</div>
            </div>
        </div>
        
        <div class="text-center mb-8">
            <button id="getRecommendation" class="btn-primary text-lg mr-4">
                <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                    <path d="M7,2V4H8V18A4,4 0 0,0 12,22A4,4 0 0,0 16,18V4H17V2H7M11,16C10.4,16 10,15.6 10,15C10,14.4 10.4,14 11,14C11.6,14 12,14.4 12,15C12,15.6 11.6,16 11,16M13,12C12.4,12 12,11.6 12,11C12,10.4 12.4,10 13,10C13.6,10 14,10.4 14,11C14,11.6 13.6,12 13,12M14,7C13.4,7 13,6.6 13,6C13,5.4 13.4,5 14,5C14.6,5 15,5.4 15,6C15,6.6 14.6,7 14,7Z"></path>
                </svg>
                AI„Ç¶„Ç£„Çπ„Ç≠„ÉºÊèêÊ°à„ÇíÂèó„Åë„Çã
            </button>
            <button id="refreshRecommendation" class="btn-secondary text-lg">
                <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                    <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"></path>
                </svg>
                „É™„Éï„É¨„ÉÉ„Ç∑„É•„Åó„Å¶ÂÜçÊèêÊ°à
            </button>
        </div>
        
        <div id="loadingIndicator" class="loading" style="display: none;">
            <svg class="svg-icon animate-spin text-2xl" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none" opacity="0.25"></circle>
                <path fill="currentColor" d="M4 12a8 8 0 0 1 8-8V2.5a1.5 1.5 0 0 0-3 0V4a8 8 0 0 1 8 8h1.5a1.5 1.5 0 0 0 0-3H18a8 8 0 0 1-8 8v1.5a1.5 1.5 0 0 0 3 0V20a8 8 0 0 1-8-8H2.5a1.5 1.5 0 0 0 0 3H4z"></path>
            </svg>
            <p class="mt-2">AI„ÅåÊúÄÈÅ©„Å™„Ç¶„Ç£„Çπ„Ç≠„Éº„ÇíÂàÜÊûê‰∏≠...</p>
        </div>
        
        <div id="progressContainer" class="progress-container">
            <div id="progressText" class="progress-text">ÂàùÊúüÂåñ‰∏≠...</div>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
            <div id="progressPercentage" class="progress-percentage">0%</div>
        </div>
        
        <div id="splitLayoutContainer" style="display: none;" class="split-layout">
            <div class="recommendations-panel">
                <h2 class="text-2xl font-bold mb-4">
                    <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                        <path d="M5,9V21H1V9H5M9,21A2,2 0 0,1 7,19V9C7,8.45 7.22,7.95 7.59,7.59L14.17,1L15.23,2.06C15.5,2.33 15.67,2.7 15.67,3.11L15.64,3.43L14.69,8H21C21.55,8 22,8.45 22,9V10.5L19.5,18.61C19.3,19.15 18.8,19.5 18.22,19.5H9M9,19H18.22L21,10.5V9.5H12.78L13.96,4.19L9,9.17V19Z"></path>
                    </svg>
                    AIÊèêÊ°àÁµêÊûú
                </h2>
                <div id="recommendationSummary"></div>
                <div id="recommendationContent"></div>
                <div id="recommendationConclusion"></div>
                <div class="text-center mt-6">
                    <button id="getAnotherRecommendation" class="btn-secondary">
                        <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                            <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"></path>
                        </svg>
                        Âà•„ÅÆÊèêÊ°à
                    </button>
                </div>
            </div>
            
            <div class="chart-panel">
                <h2 class="text-2xl font-bold mb-4">
                    <svg class="svg-icon mr-2" viewBox="0 0 24 24">
                        <path d="M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"></path>
                    </svg>
                    Âë≥Ë¶ö„Éó„É≠„Éï„Ç°„Ç§„É´ÊØîËºÉ
                </h2>
                <div class="chart-container">
                    <h3 id="chartTitle">„ÅÇ„Å™„Åü„ÅÆÂ•Ω„Åø</h3>
                    <canvas id="combinedProfileChart" class="chart-canvas" style="height: 400px;"></canvas>
                </div>
                <div class="text-center mt-4">
                    <p class="text-sm text-gray-400">„Ç¶„Ç£„Çπ„Ç≠„Éº„ÅÆÈäòÊüÑ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Å®„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂ•Ω„Åø„Å®Èáç„Å≠„Å¶Ë°®Á§∫„Åï„Çå„Åæ„Åô</p>
                </div>
            </div>
        </div>
        
        <div class="custom-footer">
            Powered by Êòº„ÅÆÊúà Technology
        </div>
    </div>
    
    <script>
        class RadarChartManager {
            constructor() {
                this.chartInstance = null;
                this.canvas = null;
                this.ctx = null;
                this.userProfileData = null;
                this.currentWhiskyData = null;
                this.isInitialized = false;
            }

            initialize() {
                try {
                    this.canvas = document.getElementById('combinedProfileChart');
                    if (!this.canvas) {
                        throw new Error('CanvasË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                    }
                    
                    this.ctx = this.canvas.getContext('2d');
                    if (!this.ctx) {
                        throw new Error('Canvas contextÂèñÂæó„Å´Â§±Êïó');
                    }

                    this.destroyChart();
                    this.isInitialized = true;
                    
                } catch (error) {
                    console.error('RadarChartManagerÂàùÊúüÂåñ„Ç®„É©„Éº', error);
                    this.isInitialized = false;
                }
            }

            destroyChart() {
                if (this.chartInstance) {
                    this.chartInstance.destroy();
                    this.chartInstance = null;
                }
            }

            createUserProfile() {
                const position = whiskySystem.getCurrentPosition();
                this.userProfileData = [
                    (1 - position.y) * 5,
                    Math.random() * 2 + 2.5,
                    position.x * 5,
                    position.y * 5,
                    Math.random() * 2 + 2.5,
                    Math.random() * 2 + 2.5
                ];
                
                return this.userProfileData;
            }

            updateChart(whiskyName = null, whiskyData = null) {
                if (!this.isInitialized) {
                    console.error('„ÉÅ„É£„Éº„Éà„ÅåÂàùÊúüÂåñ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                    return false;
                }

                try {
                    if (!this.userProfileData) {
                        this.createUserProfile();
                    }

                    this.destroyChart();

                    const datasets = [{
                        label: '„ÅÇ„Å™„Åü„ÅÆÂ•Ω„Åø',
                        data: [...this.userProfileData],
                        fill: true,
                        backgroundColor: 'rgba(78, 205, 196, 0.25)',
                        borderColor: '#4ECDC4',
                        pointBackgroundColor: '#4ECDC4',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#4ECDC4',
                        borderWidth: 2,
                        pointRadius: 5
                    }];

                    if (whiskyName && whiskyData) {
                        datasets.push({
                            label: whiskyName,
                            data: [...whiskyData],
                            fill: true,
                            backgroundColor: 'rgba(255, 107, 107, 0.25)',
                            borderColor: '#FF6B6B',
                            pointBackgroundColor: '#FF6B6B',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: '#FF6B6B',
                            borderWidth: 2,
                            pointRadius: 5
                        });
                        
                        this.currentWhiskyData = whiskyData;
                    }

                    this.chartInstance = new Chart(this.ctx, {
                        type: 'radar',
                        data: {
                            labels: ['„Éï„É´„Éº„ÉÜ„Ç£„Éº', '„Çπ„Éë„Ç§„Ç∑„Éº', '„Éú„Éá„Ç£', '„Çπ„É¢„Éº„Ç≠„Éº', 'Áîò„Åï', 'Ë§áÈõë„Åï'],
                            datasets: datasets
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: {
                                        color: '#fff',
                                        font: { size: 14 }
                                    }
                                }
                            },
                            scales: {
                                r: {
                                    angleLines: { color: 'rgba(255, 255, 255, 0.2)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.2)' },
                                    pointLabels: {
                                        color: '#fff',
                                        font: { size: 12 }
                                    },
                                    ticks: { display: false },
                                    beginAtZero: true,
                                    max: 5
                                }
                            },
                            elements: {
                                line: { tension: 0.1 }
                            },
                            animation: {
                                duration: 800,
                                easing: 'easeOutQuart'
                            }
                        }
                    });

                    return true;

                } catch (error) {
                    console.error('„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà‰ΩúÊàê„Ç®„É©„Éº', error);
                    return false;
                }
            }

            showUserProfileOnly() {
                this.updateChart();
                const titleElement = document.getElementById('chartTitle');
                if (titleElement) {
                    titleElement.textContent = '„ÅÇ„Å™„Åü„ÅÆÂ•Ω„Åø';
                }
            }

            showWhiskyComparison(whiskyName, whiskyData) {
                this.updateChart(whiskyName, whiskyData);
                const titleElement = document.getElementById('chartTitle');
                if (titleElement) {
                    titleElement.textContent = `„ÅÇ„Å™„Åü„ÅÆÂ•Ω„Åø vs ${whiskyName}`;
                }
            }
        }

        class WhiskyDataManager {
            constructor() {
                this.whiskyData = [];
                this.isLoaded = false;
            }

            async loadFromFile(file) {
                try {
                    const text = await file.text();
                    const data = JSON.parse(text);
                    this.processData(data);
                    return true;
                } catch (error) {
                    console.error('JSON„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
                    return false;
                }
            }

            async loadFromUrl(url) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    const data = await response.json();
                    this.processData(data);
                    return true;
                } catch (error) {
                    console.error('JSON URLË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
                    return false;
                }
            }

            async autoLoad() {
                const urls = [
                    './whisky_data.json',
                    './whiskey_data.json',
                    './data.json'
                ];

                for (const url of urls) {
                    try {
                        const success = await this.loadFromUrl(url);
                        if (success) {
                            console.log(`JSON„Éï„Ç°„Ç§„É´Ëá™ÂãïË™≠„ÅøËæº„ÅøÊàêÂäü: ${url}`);
                            return true;
                        }
                    } catch (error) {
                        continue;
                    }
                }

                this.loadDefaultData();
                return true;
            }

            processData(data) {
                if (data.whiskies && Array.isArray(data.whiskies)) {
                    this.whiskyData = data.whiskies;
                } else if (Array.isArray(data)) {
                    this.whiskyData = data;
                } else {
                    throw new Error('ÁÑ°Âäπ„Å™JSON„Éï„Ç©„Éº„Éû„ÉÉ„Éà');
                }
                this.isLoaded = true;
                this.updateStatus();
            }

            loadDefaultData() {
                this.whiskyData = [
                    {
                        id: "1",
                        name: "„Éû„ÉÉ„Ç´„É©„É≥ 12Âπ¥",
                        price: "¬•8,000",
                        amount: "¬•8,000",
                        category: "Whiskey",
                        region: "Speyside, Scotland",
                        subcategory: "Single Malt Scotch Whisky",
                        tastingNote_ja: "„Ç∑„Çß„É™„ÉºÊ®ΩÁî±Êù•„ÅÆË±ä„Åã„Å™„Éï„É´„Éº„ÉÑ„Ç±„Éº„Ç≠„ÄÅ„É¨„Éº„Ç∫„É≥„ÄÅ„Ç™„É¨„É≥„Ç∏„Éî„Éº„É´„ÅÆÈ¶ô„Çä„ÄÇÂè£ÂΩì„Åü„Çä„ÅØ„ÇØ„É™„Éº„Éü„Éº„Åß„ÄÅ„Éê„Éã„É©„ÄÅËúÇËúú„ÄÅ„Éä„ÉÉ„ÉÑ„ÅÆÈ¢®Âë≥„ÄÇ",
                        taste_profile: {
                            fruity: 4,
                            spicy: 2,
                            body: 3,
                            smoky: 1,
                            sweetness: 4,
                            complexity: 4
                        }
                    },
                    {
                        id: "2",
                        name: "„É©„Éï„É≠„Ç§„Ç∞ 10Âπ¥",
                        price: "¬•5,500",
                        amount: "¬•5,500",
                        category: "Whiskey",
                        region: "Islay, Scotland",
                        subcategory: "Single Malt Scotch Whisky",
                        tastingNote_ja: "Âº∑ÁÉà„Å™„Éî„Éº„Éà„Çπ„É¢„Éº„ÇØ„ÄÅÊµ∑Ëóª„ÄÅ„É®„Éº„Éâ„ÅÆÈ¶ô„Çä„ÄÇÂè£ÂΩì„Åü„Çä„ÅØÂäõÂº∑„Åè„ÄÅÂ°©Ê∞ó„ÄÅ„É¨„É¢„É≥„ÄÅËñ¨ËçâÁöÑ„Å™È¢®Âë≥„ÄÇ",
                        taste_profile: {
                            fruity: 2,
                            spicy: 3,
                            body: 4,
                            smoky: 5,
                            sweetness: 2,
                            complexity: 4
                        }
                    }
                ];
                this.isLoaded = true;
                this.updateStatus();
            }

            updateStatus() {
                const statusElement = document.getElementById('dataStatus');
                if (statusElement) {
                    if (this.isLoaded) {
                        statusElement.textContent = `‚úÖ ${this.whiskyData.length} ‰ª∂„ÅÆ„Ç¶„Ç£„Çπ„Ç≠„Éº„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„ÅøÊ∏à„Åø`;
                        statusElement.className = 'text-sm text-green-400';
                    } else {
                        statusElement.textContent = '„Éá„Éº„Çø„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì';
                        statusElement.className = 'text-sm text-gray-400';
                    }
                }
            }

            getWhiskies() {
                return this.whiskyData;
            }

            getWhiskyById(id) {
                return this.whiskyData.find(w => w.id === id);
            }

            filterByPreferences(preferences) {
                return this.whiskyData.filter(whisky => {
                    const profile = whisky.taste_profile;
                    if (!profile) return false;

                    const score = this.calculateSimilarityScore(profile, preferences);
                    return score > 0.3;
                }).sort((a, b) => {
                    const scoreA = this.calculateSimilarityScore(a.taste_profile, preferences);
                    const scoreB = this.calculateSimilarityScore(b.taste_profile, preferences);
                    return scoreB - scoreA;
                });
            }

            calculateSimilarityScore(profile1, profile2) {
                const keys = ['fruity', 'spicy', 'body', 'smoky', 'sweetness', 'complexity'];
                let totalDifference = 0;
                
                keys.forEach(key => {
                    const diff = Math.abs((profile1[key] || 3) - (profile2[key] || 3));
                    totalDifference += diff;
                });
                
                return 1 - (totalDifference / (keys.length * 4));
            }
        }

        class VoiceInputManager {
            constructor() {
                this.recognition = null;
                this.isRecording = false;
                this.isSupported = false;
                this.initialize();
            }

            initialize() {
                // Web Speech API „Çµ„Éù„Éº„ÉàÁ¢∫Ë™ç
                if ('webkitSpeechRecognition' in window) {
                    this.recognition = new webkitSpeechRecognition();
                    this.isSupported = true;
                } else if ('SpeechRecognition' in window) {
                    this.recognition = new SpeechRecognition();
                    this.isSupported = true;
                } else {
                    this.showNotSupported();
                    return;
                }

                // Ë®≠ÂÆö
                this.recognition.continuous = false;
                this.recognition.interimResults = false;
                this.recognition.lang = 'ja-JP';

                // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
                this.recognition.onstart = () => {
                    this.onStart();
                };

                this.recognition.onresult = (event) => {
                    this.onResult(event);
                };

                this.recognition.onerror = (event) => {
                    this.onError(event);
                };

                this.recognition.onend = () => {
                    this.onEnd();
                };

                this.updateUI();
            }

            onStart() {
                this.isRecording = true;
                const button = document.getElementById('voiceInputBtn');
                const text = document.getElementById('voiceButtonText');
                const status = document.getElementById('voiceStatus');
                
                button.classList.add('recording');
                text.textContent = 'Èå≤Èü≥‰∏≠...';
                status.textContent = 'üé§ Èü≥Â£∞„ÇíË™çË≠ò‰∏≠„Åß„Åô„ÄÇË©±„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';
                status.className = 'text-sm text-blue-400 mt-2';
            }

            onResult(event) {
                const transcript = event.results[0][0].transcript;
                const confidence = event.results[0][0].confidence;
                
                const textarea = document.getElementById('additionalPreferences');
                const currentText = textarea.value;
                textarea.value = currentText + (currentText ? ' ' : '') + transcript;
                
                const status = document.getElementById('voiceStatus');
                status.textContent = `‚úÖ Ë™çË≠òÂÆå‰∫Ü: "${transcript}" (‰ø°È†ºÂ∫¶: ${Math.round(confidence * 100)}%)`;
                status.className = 'text-sm text-green-400 mt-2';
            }

            onError(event) {
                console.error('Èü≥Â£∞Ë™çË≠ò„Ç®„É©„Éº:', event.error);
                const status = document.getElementById('voiceStatus');
                
                let errorMessage = '‚ùå Èü≥Â£∞Ë™çË≠ò„Ç®„É©„Éº: ';
                switch(event.error) {
                    case 'no-speech':
                        errorMessage += 'Èü≥Â£∞„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ';
                        break;
                    case 'audio-capture':
                        errorMessage += '„Éû„Ç§„ÇØ„Å´„Ç¢„ÇØ„Çª„Çπ„Åß„Åç„Åæ„Åõ„Çì„ÄÇ';
                        break;
                    case 'not-allowed':
                        errorMessage += '„Éû„Ç§„ÇØ„ÅÆ‰ΩøÁî®„ÅåË®±ÂèØ„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ';
                        break;
                    case 'network':
                        errorMessage += '„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ';
                        break;
                    default:
                        errorMessage += event.error;
                }
                
                status.textContent = errorMessage;
                status.className = 'text-sm text-red-400 mt-2';
            }

            onEnd() {
                this.isRecording = false;
                const button = document.getElementById('voiceInputBtn');
                const text = document.getElementById('voiceButtonText');
                
                button.classList.remove('recording');
                text.textContent = 'Èü≥Â£∞ÂÖ•Âäõ';
                
                setTimeout(() => {
                    const status = document.getElementById('voiceStatus');
                    status.textContent = '„Éû„Ç§„ÇØ„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Èü≥Â£∞ÂÖ•Âäõ„ÇíÈñãÂßã';
                    status.className = 'text-sm text-gray-400 mt-2';
                }, 3000);
            }

            showNotSupported() {
                const button = document.getElementById('voiceInputBtn');
                const text = document.getElementById('voiceButtonText');
                const status = document.getElementById('voiceStatus');
                
                button.disabled = true;
                text.textContent = 'Èü≥Â£∞ÂÖ•ÂäõÈùûÂØæÂøú';
                status.textContent = '„Åì„ÅÆ„Éñ„É©„Ç¶„Ç∂„ÅØÈü≥Â£∞ÂÖ•Âäõ„Çí„Çµ„Éù„Éº„Éà„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ';
                status.className = 'text-sm text-yellow-400 mt-2';
            }

            updateUI() {
                const status = document.getElementById('voiceStatus');
                if (this.isSupported) {
                    status.textContent = '„Éû„Ç§„ÇØ„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Èü≥Â£∞ÂÖ•Âäõ„ÇíÈñãÂßã';
                    status.className = 'text-sm text-gray-400 mt-2';
                } else {
                    this.showNotSupported();
                }
            }

            async startRecording() {
                if (!this.isSupported || this.isRecording) {
                    return;
                }

                try {
                    // „Éû„Ç§„ÇØË®±ÂèØ„ÇíË¶ÅÊ±Ç
                    await navigator.mediaDevices.getUserMedia({ audio: true });
                    this.recognition.start();
                } catch (error) {
                    console.error('„Éû„Ç§„ÇØË®±ÂèØ„Ç®„É©„Éº:', error);
                    const status = document.getElementById('voiceStatus');
                    status.textContent = '‚ùå „Éû„Ç§„ÇØ„ÅÆ‰ΩøÁî®Ë®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ„Éñ„É©„Ç¶„Ç∂„ÅÆË®≠ÂÆö„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ';
                    status.className = 'text-sm text-red-400 mt-2';
                }
            }

            stopRecording() {
                if (this.isRecording && this.recognition) {
                    this.recognition.stop();
                }
            }

            toggleRecording() {
                if (this.isRecording) {
                    this.stopRecording();
                } else {
                    this.startRecording();
                }
            }
        }

        class EventManager {
            constructor() {
                this.whiskyCardHandlers = new Map();
            }

            setupWhiskyCardEvents() {
                this.clearWhiskyCardEvents();

                const whiskyCards = document.querySelectorAll('.whisky-card');

                whiskyCards.forEach((card, index) => {
                    const handler = (event) => {
                        event.preventDefault();
                        event.stopPropagation();
                        
                        const titleElement = card.querySelector('h4');
                        if (titleElement) {
                            const fullText = titleElement.textContent;
                            const whiskyName = fullText.replace(/^\d+\.\s*/, '').replace(/^üåü „Åä„Åô„Åô„ÇÅ\s*/, '').trim();
                            this.handleWhiskyCardClick(whiskyName, card);
                        }
                    };

                    card.addEventListener('click', handler);
                    this.whiskyCardHandlers.set(card, handler);

                    card.addEventListener('mouseenter', () => {
                        if (!card.classList.contains('selected')) {
                            card.style.transform = 'translateY(-4px)';
                            card.style.boxShadow = '0 8px 25px rgba(78, 205, 196, 0.3)';
                        }
                    });

                    card.addEventListener('mouseleave', () => {
                        if (!card.classList.contains('selected')) {
                            card.style.transform = 'translateY(0)';
                            card.style.boxShadow = '';
                        }
                    });
                });
            }

            clearWhiskyCardEvents() {
                this.whiskyCardHandlers.forEach((handler, card) => {
                    card.removeEventListener('click', handler);
                });
                this.whiskyCardHandlers.clear();
            }

            handleWhiskyCardClick(whiskyName, clickedCard) {
                // „Åô„Åπ„Å¶„ÅÆ„Ç´„Éº„Éâ„ÅÆÈÅ∏ÊäûÁä∂ÊÖã„Çí„É™„Çª„ÉÉ„Éà
                document.querySelectorAll('.whisky-card').forEach(card => {
                    card.classList.remove('selected');
                    card.style.transform = 'translateY(0)';
                    card.style.boxShadow = '';
                });

                // „ÇØ„É™„ÉÉ„ÇØ„Åï„Çå„Åü„Ç´„Éº„Éâ„ÇíÈÅ∏ÊäûÁä∂ÊÖã„Å´
                clickedCard.classList.add('selected');
                clickedCard.style.transform = 'translateY(-4px)';
                clickedCard.style.boxShadow = '0 8px 25px rgba(78, 205, 196, 0.5)';

                // „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÇíÊõ¥Êñ∞
                const whiskyItem = whiskySystem.dataManager.getWhiskies().find(w => 
                    w.name === whiskyName || w.name.includes(whiskyName) || whiskyName.includes(w.name)
                );
                
                if (whiskyItem && whiskyItem.taste_profile) {
                    const tasteData = [
                        whiskyItem.taste_profile.fruity || 3,
                        whiskyItem.taste_profile.spicy || 3,
                        whiskyItem.taste_profile.body || 3,
                        whiskyItem.taste_profile.smoky || 3,
                        whiskyItem.taste_profile.sweetness || 3,
                        whiskyItem.taste_profile.complexity || 3
                    ];
                    whiskySystem.radarChart.showWhiskyComparison(whiskyName, tasteData);
                }
            }
        }

        class WhiskySystem {
            constructor() {
                this.dataManager = new WhiskyDataManager();
                this.radarChart = new RadarChartManager();
                this.eventManager = new EventManager();
                this.voiceManager = new VoiceInputManager();
                this.currentPosition = { x: 0.5, y: 0.5 };
                this.isInitialized = false;
            }

            async init() {
                try {
                    console.log('WhiskySystemÂàùÊúüÂåñÈñãÂßã...');
                    
                    await this.dataManager.autoLoad();
                    this.radarChart.initialize();
                    this.setupEventListeners();
                    this.setupTasteMatrix();
                    this.setupPriceSliders();
                    this.setupAxisControls();
                    this.setupJsonManager();
                    
                    this.isInitialized = true;
                    console.log('WhiskySystemÂàùÊúüÂåñÂÆå‰∫Ü');
                    
                } catch (error) {
                    console.error('WhiskySystemÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
                    this.showError('„Ç∑„Çπ„ÉÜ„É†„ÅÆÂàùÊúüÂåñ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„Éö„Éº„Ç∏„ÇíÂÜçË™≠„ÅøËæº„Åø„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                }
            }

            setupJsonManager() {
                const loadJsonFile = document.getElementById('loadJsonFile');
                const loadFromUrl = document.getElementById('loadFromUrl');
                const jsonFileInput = document.getElementById('jsonFileInput');
                const jsonUrl = document.getElementById('jsonUrl');

                loadJsonFile.addEventListener('click', () => {
                    jsonFileInput.click();
                });

                loadFromUrl.addEventListener('click', () => {
                    const urlInput = document.getElementById('jsonUrl');
                    if (urlInput.style.display === 'none') {
                        urlInput.style.display = 'block';
                        urlInput.focus();
                    } else {
                        const url = urlInput.value.trim();
                        if (url) {
                            this.loadJsonFromUrl(url);
                        }
                    }
                });

                jsonFileInput.addEventListener('change', (event) => {
                    const file = event.target.files[0];
                    if (file) {
                        this.loadJsonFromFile(file);
                    }
                });

                jsonUrl.addEventListener('keypress', (event) => {
                    if (event.key === 'Enter') {
                        const url = event.target.value.trim();
                        if (url) {
                            this.loadJsonFromUrl(url);
                        }
                    }
                });
            }

            async loadJsonFromFile(file) {
                try {
                    const success = await this.dataManager.loadFromFile(file);
                    if (success) {
                        this.showSuccess('JSON„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ');
                    } else {
                        this.showError('JSON„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
                    }
                } catch (error) {
                    this.showError(`„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº: ${error.message}`);
                }
            }

            async loadJsonFromUrl(url) {
                try {
                    const success = await this.dataManager.loadFromUrl(url);
                    if (success) {
                        this.showSuccess('Â§ñÈÉ®JSON„ÅÆË™≠„ÅøËæº„Åø„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ');
                        document.getElementById('jsonUrl').style.display = 'none';
                        document.getElementById('jsonUrl').value = '';
                    } else {
                        this.showError('Â§ñÈÉ®JSON„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
                    }
                } catch (error) {
                    this.showError(`URLË™≠„ÅøËæº„Åø„Ç®„É©„Éº: ${error.message}`);
                }
            }

            setupEventListeners() {
                const getRecommendationBtn = document.getElementById('getRecommendation');
                const refreshBtn = document.getElementById('refreshRecommendation');
                const anotherRecommendationBtn = document.getElementById('getAnotherRecommendation');
                const voiceBtn = document.getElementById('voiceInputBtn');

                getRecommendationBtn?.addEventListener('click', () => this.getRecommendations());
                refreshBtn?.addEventListener('click', () => this.refreshRecommendations());
                anotherRecommendationBtn?.addEventListener('click', () => this.getAnotherRecommendation());
                voiceBtn?.addEventListener('click', () => this.voiceManager.toggleRecording());
            }

            setupTasteMatrix() {
                const matrix = document.getElementById('tasteMatrix');
                const dot = document.getElementById('tasteDot');
                const coordinatesDisplay = document.getElementById('coordinates');

                matrix.addEventListener('click', (e) => {
                    const rect = matrix.getBoundingClientRect();
                    const x = (e.clientX - rect.left) / rect.width;
                    const y = (e.clientY - rect.top) / rect.height;

                    this.currentPosition = { x, y };

                    dot.style.left = `${x * 100}%`;
                    dot.style.top = `${y * 100}%`;

                    coordinatesDisplay.textContent = `Â∫ßÊ®ô: X: ${x.toFixed(2)}, Y: ${y.toFixed(2)}`;

                    // „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÇíÊõ¥Êñ∞
                    this.radarChart.showUserProfileOnly();
                });
            }

            setupPriceSliders() {
                const minPriceSlider = document.getElementById('minPrice');
                const maxPriceSlider = document.getElementById('maxPrice');
                const minPriceDisplay = document.getElementById('minPriceDisplay');
                const maxPriceDisplay = document.getElementById('maxPriceDisplay');

                const updatePriceDisplay = () => {
                    const minValue = parseInt(minPriceSlider.value) * 1000;
                    const maxValue = parseInt(maxPriceSlider.value) * 1000;
                    
                    minPriceDisplay.textContent = `¬•${minValue.toLocaleString()}`;
                    maxPriceDisplay.textContent = `¬•${maxValue.toLocaleString()}`;
                };

                minPriceSlider.addEventListener('input', updatePriceDisplay);
                maxPriceSlider.addEventListener('input', updatePriceDisplay);

                updatePriceDisplay();
            }

            setupAxisControls() {
                const xAxisSelect = document.getElementById('xAxis');
                const yAxisSelect = document.getElementById('yAxis');

                const updateLabels = () => {
                    const xValue = xAxisSelect.value;
                    const yValue = yAxisSelect.value;

                    const labels = {
                        'light-heavy': ['„É©„Ç§„Éà', '„Éò„Éì„Éº'],
                        'sweet-dry': ['„Çπ„Ç§„Éº„Éà', '„Éâ„É©„Ç§'],
                        'young-aged': ['Ëã•„ÅÑ', 'ÁÜüÊàê'],
                        'fruity-smoky': ['„Éï„É´„Éº„ÉÜ„Ç£„Éº', '„Çπ„É¢„Éº„Ç≠„Éº'],
                        'mild-strong': ['„Åæ„Çç„ÇÑ„Åã', 'Âº∑ÁÉà'],
                        'floral-peaty': ['„Éï„É≠„Éº„É©„É´', '„Éî„Éº„Éà']
                    };

                    document.getElementById('leftLabel').textContent = labels[xValue][0];
                    document.getElementById('rightLabel').textContent = labels[xValue][1];
                    document.getElementById('topLabel').textContent = labels[yValue][0];
                    document.getElementById('bottomLabel').textContent = labels[yValue][1];
                };

                xAxisSelect.addEventListener('change', updateLabels);
                yAxisSelect.addEventListener('change', updateLabels);

                updateLabels();
            }

            getCurrentPosition() {
                return this.currentPosition;
            }

            getRecommendations() {
                const whiskies = this.dataManager.getWhiskies();
                if (!whiskies || whiskies.length === 0) {
                    this.showError('„Ç¶„Ç£„Çπ„Ç≠„Éº„Éá„Éº„Çø„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇJSON„Éï„Ç°„Ç§„É´„ÇíË™≠„ÅøËæº„Çì„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    return;
                }

                this.showLoading(true);

                // „É¶„Éº„Ç∂„Éº„ÅÆÂ•Ω„Åø„ÇíÊï∞ÂÄ§Âåñ
                const userPreferences = {
                    fruity: (1 - this.currentPosition.y) * 5,
                    spicy: Math.random() * 2 + 2.5,
                    body: this.currentPosition.x * 5,
                    smoky: this.currentPosition.y * 5,
                    sweetness: Math.random() * 2 + 2.5,
                    complexity: Math.random() * 2 + 2.5
                };

                setTimeout(() => {
                    const recommendations = this.dataManager.filterByPreferences(userPreferences);
                    this.displayRecommendations(recommendations.slice(0, 5), userPreferences);
                    this.showLoading(false);
                    this.radarChart.showUserProfileOnly();
                }, 1500);
            }

            displayRecommendations(recommendations, userPreferences) {
                const container = document.getElementById('recommendationContent');
                const summaryContainer = document.getElementById('recommendationSummary');
                const splitLayout = document.getElementById('splitLayoutContainer');

                if (!recommendations.length) {
                    container.innerHTML = '<p class="text-center text-gray-400">Êù°‰ª∂„Å´Âêà„ÅÜ„Ç¶„Ç£„Çπ„Ç≠„Éº„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ</p>';
                    return;
                }

                // „Çµ„Éû„É™„ÉºË°®Á§∫
                summaryContainer.innerHTML = `
                    <div class="recommendation-summary">
                        <h3 class="font-bold mb-2">üéØ „ÅÇ„Å™„Åü„Å´„Åä„Åô„Åô„ÇÅ„ÅÆ„Ç¶„Ç£„Çπ„Ç≠„Éº</h3>
                        <p>„ÅÇ„Å™„Åü„ÅÆÂë≥Ë¶ö„Éó„É≠„Éï„Ç°„Ç§„É´„Å´Âü∫„Å•„ÅÑ„Å¶„ÄÅ${recommendations.length}„Å§„ÅÆ„Ç¶„Ç£„Çπ„Ç≠„Éº„ÇíÂé≥ÈÅ∏„Åó„Åæ„Åó„Åü„ÄÇ</p>
                        <p class="text-sm mt-2">Áâπ„Å´1Áï™ÁõÆ„ÅØÊúÄ„ÇÇ„Åä„Åô„Åô„ÇÅ„Åß„ÅôÔºÅ</p>
                    </div>
                `;

                // „É¨„Ç≥„É°„É≥„Éá„Éº„Ç∑„Éß„É≥Ë°®Á§∫
                let html = '';
                recommendations.forEach((whisky, index) => {
                    const isRecommended = index === 0; // ÊúÄÂàù„ÅÆ1„Å§„Çí„Åä„Åô„Åô„ÇÅ„Å®„Åó„Å¶Âº∑Ë™ø
                    const similarity = this.dataManager.calculateSimilarityScore(whisky.taste_profile, userPreferences);
                    const matchPercentage = Math.round(similarity * 100);

                    html += `
                        <div class="whisky-card ${isRecommended ? 'recommended' : ''}" data-whisky-id="${whisky.id}">
                            <h4 class="text-lg font-bold mb-2 whisky-name">${index + 1}. ${whisky.name}</h4>
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div>
                                    <p><strong>Âú∞Âüü:</strong> ${whisky.region || 'Unknown'}</p>
                                    <p><strong>ÂàÜÈ°û:</strong> ${whisky.subcategory || whisky.category}</p>
                                    <p><strong>„Éû„ÉÉ„ÉÅÁéá:</strong> <span class="text-green-400">${matchPercentage}%</span></p>
                                </div>
                                <div>
                                    <p><strong>‰æ°Ê†º:</strong> ${whisky.price || 'Êú™Ë®≠ÂÆö'}</p>
                                    <div class="mt-2">
                                        <div class="text-xs text-gray-400">Âë≥Ë¶ö„Éó„É≠„Éï„Ç°„Ç§„É´</div>
                                        <div class="flex gap-1 mt-1">
                                            <span class="px-1 py-0.5 bg-red-900 rounded text-xs">F:${whisky.taste_profile?.fruity || 3}</span>
                                            <span class="px-1 py-0.5 bg-orange-900 rounded text-xs">S:${whisky.taste_profile?.spicy || 3}</span>
                                            <span class="px-1 py-0.5 bg-yellow-900 rounded text-xs">B:${whisky.taste_profile?.body || 3}</span>
                                            <span class="px-1 py-0.5 bg-gray-900 rounded text-xs">Sm:${whisky.taste_profile?.smoky || 3}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3">
                                <p class="text-sm text-gray-300">${whisky.tastingNote_ja || '„ÉÜ„Ç§„Çπ„ÉÜ„Ç£„É≥„Ç∞„Éé„Éº„Éà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ'}</p>
                            </div>
                            ${isRecommended ? '<div class="mt-2 text-sm text-orange-300">üëë „Åì„ÅÆÈäòÊüÑ„Åå„ÅÇ„Å™„Åü„Å´ÊúÄ„ÇÇ„Åä„Åô„Åô„ÇÅ„Åß„ÅôÔºÅ</div>' : ''}
                        </div>
                    `;
                });

                container.innerHTML = html;
                splitLayout.style.display = 'grid';

                // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö
                this.eventManager.setupWhiskyCardEvents();
            }

            refreshRecommendations() {
                // ‰ΩçÁΩÆ„Çí„É©„É≥„ÉÄ„É†„Å´Â§âÊõ¥
                this.currentPosition.x = Math.random();
                this.currentPosition.y = Math.random();

                const dot = document.getElementById('tasteDot');
                const coordinatesDisplay = document.getElementById('coordinates');

                dot.style.left = `${this.currentPosition.x * 100}%`;
                dot.style.top = `${this.currentPosition.y * 100}%`;

                coordinatesDisplay.textContent = `Â∫ßÊ®ô: X: ${this.currentPosition.x.toFixed(2)}, Y: ${this.currentPosition.y.toFixed(2)}`;

                this.getRecommendations();
            }

            getAnotherRecommendation() {
                this.getRecommendations();
            }

            showLoading(show) {
                const loadingIndicator = document.getElementById('loadingIndicator');
                if (loadingIndicator) {
                    loadingIndicator.style.display = show ? 'block' : 'none';
                }
            }

            showError(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error';
                errorDiv.textContent = message;
                document.querySelector('.container-custom').prepend(errorDiv);

                setTimeout(() => {
                    errorDiv.remove();
                }, 5000);
            }

            showSuccess(message) {
                const successDiv = document.createElement('div');
                successDiv.className = 'success';
                successDiv.textContent = message;
                document.querySelector('.container-custom').prepend(successDiv);

                setTimeout(() => {
                    successDiv.remove();
                }, 3000);
            }
        }

        // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
        let whiskySystem;

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', async () => {
            whiskySystem = new WhiskySystem();
            await whiskySystem.init();
        });
    </script>


    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDks%2BTJq%2BVMoP3DSjh%2FWDdHGCCtYMAqpt5TIFUstu%2B2SY1WiqAKksJmRcuTXbtV6x6SWhs0%2FSCdeB%2BFmPb1SGWbC7pZY4FJFRSZc7ujB3WsobqBQT25lt2LcNZrazHIk1BH6BadlgyfHE5o4QLkaBpXJn3GTxWkfxHABL1RP2%2BgsR2WWfcTd%2BTX9YVfYSuGW8EaohdHcjuUNiAfRoFAv%2FRwNnRhg%2FZ%2F1RXQUi35W5QdETaSBHLljmjXTN2GeT8y9WZC5HooE%2BIf774M13rhGcWta%2BiKnofAguFn6d4Y%2FIGYVCXgFuphcSwS2tby96ZSuXazhy6z32ZtBonHQA4ismzlB3tYjw6NvqiVw4OA9Mo9XlQeCx5yWQ0vvQffrb9CR1TVybRh%2F%2BNdUmVOWoSLC%2BhWSjFItQZvGWhBpV5iz13SuMIpPu7ct%2Fbg2cUnTlWzYlIJ%2FeO5Hj2rl4lrRFAB5uLrsTyLT3hswrYUWpFjCGb7y1r8pjTTm5ay0loWx8W91BSdP30UdW79S2gsoZSYwLiQw%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDks+TJq+VMoP3DSjh/WDdHGCCtYMAqpt5TIFUstu+2SY1WiqAKksJmRcuTXbtV6x6SWhs0/SCdeB+FmPb1SGWbC7pZY4FJFRSZc7ujB3WsobqBQT25lt2LcNZrazHIk1BH6BadlgyfHE5o4QLkaBpXJn3GTxWkfxHABL1RP2+gsR2WWfcTd+TX9YVfYSuGW8EaohdHcjuUNiAfRoFAv/RwNnRhg/Z/1RXQUi35W5QdETaSBHLljmjXTN2GeT8y9WZC5HooE+If774M13rhGcWta+iKnofAguFn6d4Y/IGYVCXgFuphcSwS2tby96ZSuXazhy6z32ZtBonHQA4ismzlB3tYjw6NvqiVw4OA9Mo9XlQeCx5yWQ0vvQffrb9CR1TVybRh/+NdUmVOWoSLC+hWSjFItQZvGWhBpV5iz13SuMIpPu7ct/bg2cUnTlWzYlIJ/eO5Hj2rl4lrRFAB5uLrsTyLT3hswrYUWpFjCGb7y1r8pjTTm5ay0loWx8W91BSdP30UdW79S2gsoZSYwLiQw=";
    </script>
    
    <script id="html_notice_dialog_script" src="./index_files/notice_dialog.js.„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ"></script>
    </body></html>