<!DOCTYPE html>
<!-- saved from url=(0135)https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/tooluse_EB76Z_WrSAi0cBzgErhc4Q/whisky_sommelier_responsive.html -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜¼ã®æœˆã€‚AIã‚½ãƒ ãƒªã‚¨</title>
    <link href="./index_files/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./index_files/all.min.css">
    <script src="./index_files/chart.js.ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰"></script>
    <!-- Leaflet.jsåœ°å›³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
    <link rel="stylesheet" href="./index_files/leaflet.css" crossorigin="">
    <script src="./index_files/leaflet.js.ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰" crossorigin=""></script>
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Noto Sans JP', sans-serif;
        }
        .header-container {
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .logo {
            width: 90px;
            height: 90px;
            position: absolute;
            left: 20px;
            object-fit: contain;
            border-radius: 8px;
            background: rgba(78, 205, 197, 0);
            border: 2px solid #4ecdc500;
            padding: 5px;
        }
        
        .header-title {
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin: 0;
        }
        .container-custom {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 20px 20px;
        }
        .taste-matrix {
            width: 300px;
            height: 300px;
            border: 2px solid #fff;
            position: relative;
            background: linear-gradient(to right, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 50%, rgba(255,255,255,0.1) 100%), 
                        linear-gradient(to top, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 50%, rgba(255,255,255,0.1) 100%);
        }
        .taste-dot {
            width: 16px;
            height: 16px;
            background-color: #ff6b6b;
            border-radius: 50%;
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }
        .dual-matrix-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 20px;
        }
        .matrix-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .matrix-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #4ecdc4;
        }
        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
        }
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            backdrop-filter: blur(10px);
        }
        .whisky-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .whisky-card:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: #4ecdc4;
            transform: translateY(-2px);
        }
        .whisky-card.selected {
            background: rgba(78, 205, 196, 0.15);
            border-color: #4ecdc4;
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.3);
        }
        .whisky-card.featured {
            background: linear-gradient(135deg, rgba(255, 165, 0, 0.15), rgba(255, 215, 0, 0.10));
            border: 2px solid #FFA500;
            box-shadow: 0 0 20px rgba(255, 165, 0, 0.4);
            animation: pulse-orange 2s infinite;
        }
        @keyframes pulse-orange {
            0% { box-shadow: 0 0 20px rgba(255, 165, 0, 0.4); }
            50% { box-shadow: 0 0 30px rgba(255, 165, 0, 0.6); }
            100% { box-shadow: 0 0 20px rgba(255, 165, 0, 0.4); }
        }
        .featured-label {
            position: absolute;
            top: -10px;
            right: 10px;
            background: linear-gradient(45deg, #FFA500, #FFD700);
            color: #000;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .loading {
            display: none;
            text-align: center;
            color: #4ecdc4;
        }
        .progress-container {
            display: none;
            margin-top: 20px;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            width: 0%;
            transition: width 0.3s ease;
        }
        .progress-text {
            color: #4ecdc4;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .progress-percentage {
            color: #fff;
            font-size: 16px;
            font-weight: bold;
        }
        .error {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
        }
        .success {
            color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
        }
        .price-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            margin: 10px 0;
        }
        .price-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4ecdc4;
            cursor: pointer;
        }
        .price-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4ecdc4;
            cursor: pointer;
            border: none;
        }
        .voice-input-btn {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid #4ecdc4;
            color: #4ecdc4;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .voice-input-btn:hover {
            background: rgba(78, 205, 196, 0.3);
        }
        .voice-input-btn.recording {
            background: rgba(255, 107, 107, 0.3);
            border-color: #ff6b6b;
            color: #ff6b6b;
        }
        
        .split-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: start;
        }
        
        .recommendations-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            backdrop-filter: blur(10px);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .chart-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            position: sticky;
            top: 120px;
            max-height: 80vh;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(78, 205, 196, 0.5) rgba(255, 255, 255, 0.1);
        }
        
        .chart-panel::-webkit-scrollbar {
            width: 8px;
        }
        
        .chart-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        .chart-panel::-webkit-scrollbar-thumb {
            background: rgba(78, 205, 196, 0.5);
            border-radius: 4px;
        }
        
        .chart-container {
            height: 350px;
            width: 100%;
            position: relative;
        }
        .chart-container h3 {
            text-align: center;
            margin-bottom: 20px;
            color: #4ecdc4;
            font-size: 16px;
        }
        .chart-canvas {
            height: 350px !important;
            width: 100% !important;
        }
        #combinedProfileChart {
            height: 320px !important;
            width: 100% !important;
        }
        .recommendation-summary {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
            color: #4ecdc4;
        }
        
        .custom-footer {
            display: none;
            text-align: center;
            padding: 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            margin-top: 40px;
        }
        
        .whisky-overview {
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.1), rgba(255, 107, 107, 0.1));
            border: 2px solid rgba(78, 205, 196, 0.3);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .whisky-overview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .whisky-overview h2 {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #4ecdc4, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .whisky-overview .subtitle {
            font-size: 1.2rem;
            color: #4ecdc4;
            margin-bottom: 15px;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }
        
        .whisky-overview .description {
            font-size: 1.1rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
            position: relative;
            z-index: 1;
        }
        
        .whisky-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
            position: relative;
            z-index: 1;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #ff6b6b;
            display: block;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 5px;
        }
        
        .taste-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            fill: #4ecdc4;
        }

        .chat-section {
            margin-top: 30px;
        }

        .chat-examples {
            background: rgba(78, 205, 196, 0.05);
            border: 1px solid rgba(78, 205, 196, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .question-example {
            display: block;
            padding: 8px 12px;
            margin-bottom: 8px;
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 6px;
            color: #4ecdc4;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-example:hover {
            background: rgba(78, 205, 196, 0.2);
            transform: translateY(-1px);
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 12px;
            color: #fff;
            font-size: 14px;
        }

        .chat-input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.2);
        }

        .chat-history {
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }

        .chat-message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 8px;
            word-wrap: break-word;
            white-space: pre-wrap;
            line-height: 1.6;
            font-size: 14px;
        }

        .ai-message {
            background: rgba(78, 205, 196, 0.15);
            border-left: 3px solid #4ecdc4;
            color: #fff;
        }

        .user-message {
            background: rgba(255, 107, 107, 0.15);
            border-left: 3px solid #ff6b6b;
            color: #fff;
        }

        .chat-history::-webkit-scrollbar {
            width: 6px;
        }

        .chat-history::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .chat-history::-webkit-scrollbar-thumb {
            background: rgba(78, 205, 196, 0.5);
            border-radius: 3px;
        }
        
        /* ã‚¹ãƒãƒ›è¡¨ç¤ºæ™‚ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ”¹å–„ */
        .header-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 0;
        }

        .nav-links {
            position: relative;
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.2s ease;
            padding: 5px 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .nav-link:hover {
            color: #fff;
            background: rgba(78, 205, 196, 0.2);
        }
        
        .nav-link.active {
            color: #fff;
            background: rgba(78, 205, 196, 0.3);
            border-bottom: 2px solid #4ecdc4;
        }

        .ai-recommendation-message {
            background: rgba(78, 205, 196, 0.15);
            border-left: 3px solid #4ecdc4;
            color: #fff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        /* ã‚¹ãƒãƒ›è¡¨ç¤ºæ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´ */
        @media (min-width: 768px) {
            .header-container {
                flex-direction: row;
                justify-content: center;
                padding: 15px 0;
            }
            
            .nav-links {
                position: absolute;
                right: 20px;
                margin-top: 0;
            }
            
            .logo {
                position: absolute;
                left: 20px;
            }
            
            .menu-toggle {
                display: none;
            }
        }
        
        @media (max-width: 767px) {
            .container-custom {
                padding-top: 140px;  /* ãƒ˜ãƒƒãƒ€ãƒ¼ã®é«˜ã•ã«åˆã‚ã›ã¦èª¿æ•´ */
            }
            
            .header-title {
                font-size: 20px;
                margin-bottom: 5px;
                padding-left: 70px;  /* ãƒ­ã‚´åˆ†ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç©ºã‘ã‚‹ */
                text-align: center;
                width: 100%;
            }
            
            .logo {
                width: 40px;
                height: 40px;
                top: 50%;
                transform: translateY(-50%);
            }
            
            .chat-input-container {
                flex-direction: column;
            }
            
            .voice-input-btn {
                width: 100%;
                margin-top: 10px;
            }
            
            .dual-matrix-container {
                grid-template-columns: 1fr;
            }
            
            .split-layout {
                grid-template-columns: 1fr;
            }
            
            .whisky-overview h2 {
                font-size: 1.8rem;
            }
            
            .nav-links {
                width: 100%;
                justify-content: center;
            }
            
            .menu-toggle {
                position: absolute;
                top: 15px;
                right: 15px;
                font-size: 24px;
                color: #4ecdc4;
                background: none;
                border: none;
                cursor: pointer;
                display: none;  /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼å±•é–‹ãƒœã‚¿ãƒ³ã¯éè¡¨ç¤ºï¼ˆå¸¸ã«è¡¨ç¤ºã™ã‚‹ãŸã‚ï¼‰ */
            }
        }

        /* è’¸ç•™æ‰€ãƒãƒƒãƒ—ã¨æƒ…å ±ãƒ‘ãƒãƒ« */
        .distillery-section {
            margin-top: 20px;
            opacity: 0;
            height: 0;
            overflow: hidden;
            transition: opacity 0.8s ease, height 0.8s ease;
        }

        .distillery-section.active {
            opacity: 1;
            height: auto;
        }

        .distillery-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .map-container {
            height: 300px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid rgba(78, 205, 196, 0.3);
            background-color: #1a1a1a;
        }

        #distilleryMap {
            height: 100%;
            width: 100%;
            background-color: #242424;
        }

        .distillery-info {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 12px;
            padding: 16px;
            color: #fff;
        }

        .distillery-info h3 {
            color: #4ecdc4;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(78, 205, 196, 0.3);
            padding-bottom: 8px;
        }

        .distillery-info-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 8px 16px;
            margin-top: 15px;
        }

        .info-label {
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
        }

        .info-value {
            color: rgba(255, 255, 255, 0.9);
        }

        .distillery-description {
            margin-top: 15px;
            line-height: 1.6;
        }

        .status-active {
            color: #4ecdc4;
            font-weight: bold;
        }

        .status-closed {
            color: #ff6b6b;
            font-weight: bold;
        }

        .status-unknown {
            color: #ffb347;
            font-weight: bold;
        }

        /* Leafletãƒãƒƒãƒ—ã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        .leaflet-container {
            background-color: #242424 !important;
        }
        .leaflet-tile-pane {
            opacity: 0.9;
        }
        .leaflet-popup-content-wrapper {
            background-color: rgba(40, 44, 52, 0.95) !important;
            color: #fff !important;
            border: 1px solid rgba(78, 205, 196, 0.5);
        }
        .leaflet-popup-tip {
            background-color: rgba(40, 44, 52, 0.95) !important;
        }
        .leaflet-control-zoom a {
            background-color: rgba(40, 44, 52, 0.8) !important;
            color: #fff !important;
            border-color: rgba(78, 205, 196, 0.3) !important;
        }
        .leaflet-control-zoom a:hover {
            background-color: rgba(78, 205, 196, 0.3) !important;
        }
        
        /* éŸ³å£°å…¥åŠ›ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .voice-input-btn {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid #4ecdc4;
            color: #4ecdc4;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }

        .voice-input-btn:hover {
            background: rgba(78, 205, 196, 0.3);
            transform: translateY(-2px);
        }

        .voice-input-btn.recording {
            background: rgba(255, 107, 107, 0.3);
            border-color: #ff6b6b;
            color: #ff6b6b;
            animation: pulse-recording 1.5s infinite;
        }

        @keyframes pulse-recording {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .error-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            max-width: 400px;
            animation: slide-in 0.5s ease-out;
        }

        .notification-content {
            background-color: rgba(255, 107, 107, 0.9);
            color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
        }

        .notification-icon {
            font-size: 24px;
            margin-right: 15px;
        }

        .notification-message {
            flex-grow: 1;
        }

        .notification-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            margin-left: 10px;
        }

        @keyframes slide-in {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
<style>
    .genspark-notice-dialog {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .genspark-notice-content {
      background-color: white;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-sizing: border-box;
      padding: 10px 30px 30px 30px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    .genspark-notice-title {
      color: #000;
      font-family: Arial;
      font-size: 20px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 
    }

    .genspark-notice-list {
      margin: 24px 0;
      
      color: #606366;
      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 150%;
      padding-left: 12px;
    }

    .genspark-notice-list li {
      margin-bottom: 12px;
      list-style-type: disc;
    }

    .genspark-notice-list li a {
      color: #606366;
      text-decoration: underline;
    }

    .genspark-notice-checkbox {
      display: flex;
      align-items: center;
      margin-top: 20px;
      gap: 10px;

      color: #232425;

      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: normal;
    }

    .genspark-notice-actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
      
    .genspark-notice-ok {
      color: #232425;

      text-align: center;
      font-family: Arial;
      font-size: 16px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 

      cursor: pointer;
      display: flex;
      height: 40px;
      padding: 6px 14px;
      justify-content: center;
      align-items: center;
      gap: 10px;
      align-self: stretch;
      border-radius: 8px;
      border: 1px solid #000;
      box-sizing: border-box;
      width: 100%;
    }
  </style></head>
<body>
    <div class="header-container">
        <div class="header-top">
            <img class="logo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iOCIgZmlsbD0iIzRlY2RjNCIvPgo8dGV4dCB4PSIyNSIgeT0iMzIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIj7mmIc8L3RleHQ+Cjwvc3ZnPg==" alt="æ˜¼ã®æœˆãƒãƒ¼ãƒ­ã‚´">
            <h1 class="header-title">æ˜¼ã®æœˆã€‚AIã‚½ãƒ ãƒªã‚¨</h1>
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-link active" id="homeLink">ğŸ  AIã‚½ãƒ ãƒªã‚¨</a>
            <a href="whisky_list.html" class="nav-link" id="listLink">ğŸ¥ƒ ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ä¸€è¦§</a>
        </div>
    </div>
    
    <div class="container-custom">
        <div class="whisky-overview">
            <h2>ğŸ· ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</h2>
            <div class="subtitle">æœ¬æ—¥ã¯å³é¸ã•ã‚ŒãŸ<span id="whiskyCount">3</span>æœ¬ã®ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã‹ã‚‰</div>
            <div class="description">
                <strong>ã‚ãªãŸã®å‘³è¦šã«å®Œç’§ã«ãƒãƒƒãƒã™ã‚‹</strong>æœ€é«˜ã®ä¸€æœ¬ã‚’<br>
                AIæŠ€è¡“ã§åˆ†æãƒ»ææ¡ˆã„ãŸã—ã¾ã™
            </div>
            <div class="whisky-stats">
                <div class="stat-item">
                    <span class="stat-number" id="totalWhiskies">3</span>
                    <div class="stat-label">å³é¸éŠ˜æŸ„</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="uniqueRegions">3</span>
                    <div class="stat-label">ç”£åœ°</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">AI</span>
                    <div class="stat-label">åˆ†ææŠ€è¡“</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="text-2xl font-bold mb-4">
                ğŸ’ ä¾¡æ ¼å¸¯è¨­å®š
            </h2>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block mb-2">ä¸‹é™ä¾¡æ ¼: <span id="minPriceDisplay">Â¥5,000</span></label>
                    <input type="range" id="minPrice" class="price-slider" min="1" max="80" value="5" step="1">
                </div>
                <div>
                    <label class="block mb-2">ä¸Šé™ä¾¡æ ¼: <span id="maxPriceDisplay">Â¥50,000</span></label>
                    <input type="range" id="maxPrice" class="price-slider" min="1" max="80" value="50" step="1">
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="text-2xl font-bold mb-4">
                ğŸ‘… å‘³è¦šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š
            </h2>
            <p class="mb-6">2ã¤ã®å››è§’å†…ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ãã‚Œãã‚Œã®å¥½ã¿ã®ä½ç½®ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
            
            <div class="dual-matrix-container">
                <div class="matrix-wrapper">
                    <div class="matrix-title">ğŸ¥ƒ åŸºæœ¬çš„ãªå‘³ã®å‚¾å‘</div>
                    <div class="relative">
                        <div class="taste-matrix" id="tasteMatrix1">
                            <div class="taste-dot" id="tasteDot1" style="left: 50%; top: 50%;"></div>
                        </div>
                        <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-sm">ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼</div>
                        <div class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-sm">ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼</div>
                        <div class="absolute -left-12 top-1/2 transform -translate-y-1/2 text-sm">ãƒ©ã‚¤ãƒˆ</div>
                        <div class="absolute -right-12 top-1/2 transform -translate-y-1/2 text-sm">ãƒ˜ãƒ“ãƒ¼</div>
                    </div>
                    <div class="text-center mt-4">
                        <span id="coordinates1" class="text-xs text-gray-400">åº§æ¨™: X: 0.50, Y: 0.50</span>
                    </div>
                </div>
                
                <div class="matrix-wrapper">
                    <div class="matrix-title">ğŸ¯ è¤‡é›‘ã•ã®å¥½ã¿</div>
                    <div class="relative">
                        <div class="taste-matrix" id="tasteMatrix2">
                            <div class="taste-dot" id="tasteDot2" style="left: 50%; top: 50%;"></div>
                        </div>
                        <div class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-sm">ã¾ã‚ã‚„ã‹</div>
                        <div class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-sm">å¼·çƒˆ</div>
                        <div class="absolute -left-12 top-1/2 transform -translate-y-1/2 text-sm">è‹¥ã„</div>
                        <div class="absolute -right-12 top-1/2 transform -translate-y-1/2 text-sm">ç†Ÿæˆ</div>
                    </div>
                    <div class="text-center mt-4">
                        <span id="coordinates2" class="text-xs text-gray-400">åº§æ¨™: X: 0.50, Y: 0.50</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card chat-section">
            <h2 class="text-2xl font-bold mb-4">
                ğŸ¤– AIã‚½ãƒ ãƒªã‚¨ã¨ãƒãƒ£ãƒƒãƒˆï¼ˆä½•åº¦ã§ã‚‚ãŠæ°—è»½ã«ï¼ï¼‰
            </h2>
            
            <div class="chat-examples">
                <div class="mb-3 text-sm text-gray-300">è³ªå•ä¾‹ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å…¥åŠ›ï¼‰ï¼š</div>
                <div class="question-example" data-question="ã‚¿ãƒªã‚¹ã‚«ãƒ¼44å¹´ï¼ˆæœ€é«˜é¡80,400å††ï¼‰ã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã¦">ğŸ’ ã‚¿ãƒªã‚¹ã‚«ãƒ¼44å¹´ï¼ˆæœ€é«˜é¡80,400å††ï¼‰ã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã¦</div>
                <div class="question-example" data-question="3000å††ä»¥ä¸‹ã§ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼ãªã‚¢ã‚¤ãƒ©å³¶ã®ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã¯ã‚ã‚‹ï¼Ÿ">ğŸŒŠ 3000å††ä»¥ä¸‹ã§ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼ãªã‚¢ã‚¤ãƒ©å³¶ã®ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã¯ã‚ã‚‹ï¼Ÿ</div>
                <div class="question-example" data-question="æ—¥æœ¬ã®è»½äº•æ²¢ã‚„é•·æ¿±ãªã©ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãªã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã‚’æ¯”è¼ƒã—ã¦">ğŸ¯ æ—¥æœ¬ã®è»½äº•æ²¢ã‚„é•·æ¿±ãªã©ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãªã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã‚’æ¯”è¼ƒã—ã¦</div>
                <div class="question-example" data-question="5000å††å‰å¾Œã§complexity5ç‚¹ã®è¤‡é›‘ãªã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã®ãŠã™ã™ã‚ã¯ï¼Ÿ">â­ 5000å††å‰å¾Œã§complexity5ç‚¹ã®è¤‡é›‘ãªã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã®ãŠã™ã™ã‚ã¯ï¼Ÿ</div>
            </div>

            <div class="chat-input-container">
                <input type="text" id="chatInput" class="chat-input" placeholder="è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...">
                <button id="voiceInputBtn" class="voice-input-btn">
                    ğŸ¤
                </button>
                <button id="sendChatBtn" class="btn-primary">ğŸ’¬ è³ªå•ã™ã‚‹</button>
            </div>

            <div id="chatHistory" class="chat-history" style="display: none;"></div>
        </div>
        
        <div class="text-center mb-8">
            <button id="getRecommendation" class="btn-primary text-lg mr-4">ğŸ¯ AIã‚¦ã‚£ã‚¹ã‚­ãƒ¼ææ¡ˆã‚’å—ã‘ã‚‹</button>
            <button id="refreshRecommendation" class="btn-secondary text-lg">
                ğŸ”„ ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã—ã¦å†ææ¡ˆ
            </button>
        </div>
        
        <div id="loadingIndicator" class="loading" style="display: none;">
            <div class="animate-spin text-4xl mb-4">ğŸ¥ƒ</div>
            <p class="mt-2">AIãŒæœ€é©ãªã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã‚’åˆ†æä¸­...</p>
        </div>
        
        <div id="progressContainer" class="progress-container" style="display: none;">
            <div id="progressText" class="progress-text">çµæœã‚’ç”Ÿæˆä¸­...</div>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
            </div>
            <div id="progressPercentage" class="progress-percentage">0%</div>
        </div>
        
        <div id="splitLayoutContainer" class="split-layout" style="display: none;">
            <div id="recommendationsPanel" class="recommendations-panel">
                <h2 class="text-2xl font-bold mb-4">
                    ğŸ¯ AIææ¡ˆçµæœ
                </h2>
                <div id="preferencesSummary" class="recommendation-summary" style="display: block;">
                    <h3 class="text-lg font-bold mb-3">ğŸ¯ ã‚ãªãŸã®å¥½ã¿ã®å‚¾å‘</h3>
                    <div class="space-y-2 text-sm">
                        <div><strong>åŸºæœ¬çš„ãªå‘³ã®å‚¾å‘:</strong> <span id="tasteDescription">ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸ</span></div>
                        <div><strong>è¤‡é›‘ã•ã®å¥½ã¿:</strong> <span id="complexityDescription">ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„è¤‡é›‘ã•ã‚’å¥½ã‚€</span></div>
                        <div><strong>ä¾¡æ ¼å¸¯:</strong> <span id="priceRange">Â¥5,000 - Â¥50,000</span></div>
                
                        <div class="mt-3 pt-2 border-t border-gray-600">
                            ã“ã®ç·åˆãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«åŸºã¥ã„ã¦ã€æœ€é©ãª3éŠ˜æŸ„ã‚’å³é¸ã—ã¾ã—ãŸã€‚
                        </div>
                    </div>
                </div>
                <div id="recommendationContent"></div>
                <div class="text-center mt-6">
                    <button id="getAnotherRecommendation" class="btn-secondary">
                        ğŸ”„ åˆ¥ã®ææ¡ˆ
                    </button>
                </div>
            </div>
            
            <div id="chartPanel" class="chart-panel">
                <h2 class="text-2xl font-bold mb-4">
                    ğŸ“Š å‘³è¦šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«æ¯”è¼ƒ
                </h2>
                <div class="chart-container">
                    <h3 id="chartTitle">ã‚ãªãŸã®å¥½ã¿</h3>
                    <canvas id="combinedProfileChart" class="chart-canvas" width="0" height="0" style="width: 0px; height: 0px; display: block; box-sizing: border-box;"></canvas>
                </div>
                <div class="text-center mt-4">
                    <p class="text-sm text-gray-400">ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã®éŠ˜æŸ„ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã‚ãªãŸã®å¥½ã¿ã¨é‡ã­ã¦è¡¨ç¤ºã•ã‚Œã¾ã™</p>
                </div>
                
                <!-- è’¸ç•™æ‰€ãƒãƒƒãƒ—ã¨æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div id="distillerySection" class="distillery-section">
                    <h2 class="text-xl font-bold mb-3 text-center">
                        ğŸŒ è’¸ç•™æ‰€æƒ…å ±
                    </h2>
                    <div class="distillery-container">
                        <div class="map-container">
                            <div id="distilleryMap"></div>
                        </div>
                        
                        <div class="distillery-info" id="distilleryInfo">
                            <h3 id="distilleryName">è’¸ç•™æ‰€å</h3>
                            <div class="distillery-info-grid" id="distilleryDetails">
                                <div class="info-label">æ‰€åœ¨åœ°:</div>
                                <div class="info-value" id="distilleryRegion">-</div>
                                
                                <div class="info-label">è¨­ç«‹:</div>
                                <div class="info-value" id="distilleryFounded">-</div>
                                
                                <div class="info-label">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</div>
                                <div class="info-value" id="distilleryStatus">-</div>
                                
                                <div class="info-label">æ‰€æœ‰è€…:</div>
                                <div class="info-value" id="distilleryOwner">-</div>
                            </div>
                            
                            <div class="distillery-description mt-4" id="distilleryDescription">
                                è’¸ç•™æ‰€ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="custom-footer">
            <p>Â© 2024 æ˜¼ã®æœˆã€‚AIã‚½ãƒ ãƒªã‚¨</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä¸€è¦§ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰
            const whiskies = [
                {
                    id: 1,
                    name: "ã‚°ãƒ¬ãƒ³ãƒªãƒ™ãƒƒãƒˆ 12å¹´",
                    region: "ã‚¹ãƒšã‚¤ã‚µã‚¤ãƒ‰",
                    price: 5000,
                    description: "ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ã§ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸå‘³ã‚ã„ã€ãƒãƒ‹ãƒ©ã¨èœ‚èœœã®é¢¨å‘³ãŒç‰¹å¾´çš„ã€‚åˆå¿ƒè€…ã«ã‚‚ãŠã™ã™ã‚ã®ã‚¹ãƒšã‚¤ã‚µã‚¤ãƒ‰ãƒ¢ãƒ«ãƒˆã€‚",
                    taste_profile: {
                        fruity: 4,
                        spicy: 2,
                        body: 3,
                        smoky: 1,
                        sweetness: 4,
                        complexity: 3
                    },
                    distillery: {
                        name: "The Glenlivet",
                        region: "ã‚¹ãƒšã‚¤ã‚µã‚¤ãƒ‰, ã‚¹ã‚³ãƒƒãƒˆãƒ©ãƒ³ãƒ‰",
                        founded: "1824å¹´",
                        status: "ç¨¼åƒä¸­",
                        owner: "ãƒšãƒ«ãƒãƒ»ãƒªã‚«ãƒ¼ãƒ«",
                        description: "ã‚¹ã‚³ãƒƒãƒˆãƒ©ãƒ³ãƒ‰æœ€å¤ã®åˆæ³•è’¸ç•™æ‰€ã®ä¸€ã¤ã§ã€ç‹å®¤å¾¡ç”¨é”ã®ç§°å·ã‚’æŒã¤ç”±ç·’æ­£ã—ã„è’¸ç•™æ‰€ã§ã™ã€‚ã‚¹ãƒšã‚¤ã‚µã‚¤ãƒ‰ã®ä»£è¡¨çš„ãªè’¸ç•™æ‰€ã¨ã—ã¦ã€ãã®ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã¯ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ã§ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆãªå‘³ã‚ã„ã§ä¸–ç•Œä¸­ã«æ„›ã•ã‚Œã¦ã„ã¾ã™ã€‚",
                        lat: 57.3429,
                        lng: -3.3384
                    }
                },
                {
                    id: 2,
                    name: "ãƒ©ãƒ•ãƒ­ã‚¤ã‚° 10å¹´",
                    region: "ã‚¢ã‚¤ãƒ©",
                    price: 6500,
                    description: "å¼·çƒˆãªãƒ”ãƒ¼ãƒˆé¦™ã¨æµ·ã®é¦™ã‚ŠãŒç‰¹å¾´çš„ã€‚ã‚¢ã‚¤ã‚ªãƒ‡ã‚£ãƒ³ã€æµ·è—»ã€è–¬å“ã®ã‚ˆã†ãªãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã‚’æŒã¤å€‹æ€§çš„ãªã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã€‚",
                    taste_profile: {
                        fruity: 2,
                        spicy: 3,
                        body: 4,
                        smoky: 5,
                        sweetness: 2,
                        complexity: 4
                    },
                    distillery: {
                        name: "Laphroaig",
                        region: "ã‚¢ã‚¤ãƒ©å³¶, ã‚¹ã‚³ãƒƒãƒˆãƒ©ãƒ³ãƒ‰",
                        founded: "1815å¹´",
                        status: "ç¨¼åƒä¸­",
                        owner: "ãƒ“ãƒ¼ãƒ ãƒ»ã‚µãƒ³ãƒˆãƒªãƒ¼",
                        description: "ã‚¢ã‚¤ãƒ©å³¶å—å²¸ã«ä½ç½®ã—ã€ãã®ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã¯å¼·çƒˆãªãƒ”ãƒ¼ãƒˆé¦™ã¨è–¬å“çš„ãªå€‹æ€§ã§çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ãƒãƒ£ãƒ¼ãƒ«ã‚ºçš‡å¤ªå­å¾¡ç”¨é”ã®ç§°å·ã‚’æŒã¡ã€æ„›å¥½å®¶ã®é–“ã§ç†±ç‹‚çš„ãªæ”¯æŒã‚’é›†ã‚ã¦ã„ã¾ã™ã€‚",
                        lat: 55.6295,
                        lng: -6.1527
                    }
                },
                {
                    id: 3,
                    name: "å±±å´ 12å¹´",
                    region: "æ—¥æœ¬",
                    price: 15000,
                    description: "æ—¥æœ¬ã‚’ä»£è¡¨ã™ã‚‹ã‚·ãƒ³ã‚°ãƒ«ãƒ¢ãƒ«ãƒˆã€‚è¤‡é›‘ã§æ·±ã¿ã®ã‚ã‚‹ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãªå‘³ã‚ã„ã«ã€ã‹ã™ã‹ãªæ¨½ã®é¢¨å‘³ã¨æ—¥æœ¬ç‹¬ç‰¹ã®ç¹Šç´°ã•ãŒç‰¹å¾´ã€‚",
                    taste_profile: {
                        fruity: 5,
                        spicy: 3,
                        body: 4,
                        smoky: 2,
                        sweetness: 4,
                        complexity: 5
                    },
                    distillery: {
                        name: "ã‚µãƒ³ãƒˆãƒªãƒ¼å±±å´è’¸ç•™æ‰€",
                        region: "å¤§é˜ªåºœ, æ—¥æœ¬",
                        founded: "1923å¹´",
                        status: "ç¨¼åƒä¸­",
                        owner: "ã‚µãƒ³ãƒˆãƒªãƒ¼ãƒ›ãƒ¼ãƒ«ãƒ‡ã‚£ãƒ³ã‚°ã‚¹",
                        description: "æ—¥æœ¬åˆã®æœ¬æ ¼çš„ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼è’¸ç•™æ‰€ã¨ã—ã¦é³¥äº•ä¿¡æ²»éƒã«ã‚ˆã£ã¦è¨­ç«‹ã€‚äº¬éƒ½ã¨å¤§é˜ªã®å¢ƒã«ã‚ã‚‹å±±å´ã®åœ°ã¯ã€å¤ãã‹ã‚‰åæ°´ã®åœ°ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã€æ—¥æœ¬èŒ¶ã®ç”Ÿç”£ã§ã‚‚æœ‰åã§ã—ãŸã€‚æ—¥æœ¬ã‚’ä»£è¡¨ã™ã‚‹è’¸ç•™æ‰€ã¨ã—ã¦ã€ä¸–ç•Œçš„ã«é«˜ã„è©•ä¾¡ã‚’å—ã‘ã‚‹ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã‚’ç”Ÿç”£ã—ã¦ã„ã¾ã™ã€‚",
                        lat: 34.8924,
                        lng: 135.6762
                    }
                },
                // ä»–ã®ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã‚‚ã“ã“ã«è¿½åŠ 
            ];
            
            let profileChartInstance = null;
            let selectedWhisky = null;
            let map = null;
            let marker = null;

            // ãƒ†ã‚¤ã‚¹ãƒˆè¡Œåˆ—ã®è¨­å®š
            function setupTasteMatrices() {
                const matrix1 = document.getElementById('tasteMatrix1');
                const dot1 = document.getElementById('tasteDot1');
                const coordinates1 = document.getElementById('coordinates1');
                
                const matrix2 = document.getElementById('tasteMatrix2');
                const dot2 = document.getElementById('tasteDot2');
                const coordinates2 = document.getElementById('coordinates2');
                
                function updateDotPosition(matrix, dot, coords, event) {
                    const rect = matrix.getBoundingClientRect();
                    const x = (event.clientX - rect.left) / rect.width;
                    const y = (event.clientY - rect.top) / rect.height;
                    
                    const clampedX = Math.max(0, Math.min(1, x));
                    const clampedY = Math.max(0, Math.min(1, y));
                    
                    dot.style.left = `${clampedX * 100}%`;
                    dot.style.top = `${clampedY * 100}%`;
                    
                    coords.textContent = `åº§æ¨™: X: ${clampedX.toFixed(2)}, Y: ${clampedY.toFixed(2)}`;
                }
                
                matrix1.addEventListener('click', function(event) {
                    updateDotPosition(matrix1, dot1, coordinates1, event);
                });
                
                matrix2.addEventListener('click', function(event) {
                    updateDotPosition(matrix2, dot2, coordinates2, event);
                });
            }

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¥½ã¿ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
            function getUserProfile() {
                const matrix1Dot = document.getElementById('tasteDot1');
                const matrix2Dot = document.getElementById('tasteDot2');
                
                const matrix1Rect = document.getElementById('tasteMatrix1').getBoundingClientRect();
                const matrix2Rect = document.getElementById('tasteMatrix2').getBoundingClientRect();
                
                const pos1 = {
                    x: parseFloat((matrix1Dot.offsetLeft / matrix1Rect.width).toFixed(2)),
                    y: parseFloat((matrix1Dot.offsetTop / matrix1Rect.height).toFixed(2))
                };
                
                const pos2 = {
                    x: parseFloat((matrix2Dot.offsetLeft / matrix2Rect.width).toFixed(2)),
                    y: parseFloat((matrix2Dot.offsetTop / matrix2Rect.height).toFixed(2))
                };
                
                // å¥½ã¿ã®åº§æ¨™ã‹ã‚‰ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®å€¤ã«å¤‰æ›
                return {
                    fruity: Math.round((1 - pos1.y) * 5),  // ä¸Šå´ãŒãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼
                    spicy: Math.round(pos2.x * 3 + 2),     // å³å´ãŒã‚¹ãƒ‘ã‚¤ã‚·ãƒ¼
                    body: Math.round(pos1.x * 5),          // å³å´ãŒãƒœãƒ‡ã‚£
                    smoky: Math.round(pos1.y * 5),         // ä¸‹å´ãŒã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼
                    sweetness: Math.round((1 - pos2.y) * 5), // ä¸Šå´ãŒç”˜ã•
                    complexity: Math.round(pos2.x * 5)     // å³å´ãŒè¤‡é›‘ã•
                };
            }

            // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
            function updateProfileChart(profile, name) {
                if (!profile) return;
                
                const ctx = document.getElementById('combinedProfileChart');
                if (!ctx) return;
                
                const chartTitle = document.getElementById('chartTitle');
                chartTitle.textContent = name ? `ã‚ãªãŸã®å¥½ã¿ vs ${name}` : 'ã‚ãªãŸã®å¥½ã¿';
                
                // Canvasã‚µã‚¤ã‚ºã‚’æ˜ç¤ºçš„ã«è¨­å®š
                ctx.style.width = '100%';
                ctx.style.height = '320px';
                ctx.width = ctx.offsetWidth;
                ctx.height = 320;
                
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¥½ã¿ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
                const userProfile = getUserProfile();
                
                // Chart.jsã®è¨­å®š
                const chartOptions = {
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: {
                                color: 'rgba(255, 255, 255, 0.8)',
                                font: {
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                            enabled: true
                        }
                    },
                    scales: {
                        r: {
                            angleLines: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            pointLabels: {
                                font: {
                                    size: 16
                                },
                                color: 'rgba(255, 255, 255, 0.9)'
                            },
                            ticks: {
                                display: false,
                                backdropColor: 'transparent'
                            },
                            beginAtZero: true,
                            min: 0,
                            max: 5
                        }
                    },
                    maintainAspectRatio: false,
                    responsive: true
                };
                
                // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æº–å‚™
                const datasets = [
                    {
                        label: 'ã‚ãªãŸã®å¥½ã¿',
                        data: [
                            userProfile.fruity,
                            userProfile.spicy,
                            userProfile.body,
                            userProfile.smoky,
                            userProfile.sweetness,
                            userProfile.complexity
                        ],
                        backgroundColor: 'rgba(78, 205, 196, 0.2)',
                        borderColor: '#4ecdc4',
                        pointBackgroundColor: '#4ecdc4',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#4ecdc4',
                        fill: true
                    }
                ];
                
                // é¸æŠã—ãŸã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°è¿½åŠ 
                if (name) {
                    datasets.push({
                        label: name,
                        data: [
                            profile.fruity || 0,
                            profile.spicy || 0,
                            profile.body || 0,
                            profile.smoky || 0,
                            profile.sweetness || 0,
                            profile.complexity || 0
                        ],
                        backgroundColor: 'rgba(255, 107, 107, 0.2)',
                        borderColor: '#ff6b6b',
                        pointBackgroundColor: '#ff6b6b',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#ff6b6b',
                        fill: true
                    });
                }
                
                // Chart.jsã®æ›´æ–°ã¾ãŸã¯ä½œæˆ
                if (profileChartInstance) {
                    // æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„ã—ã¦ã‹ã‚‰å†ä½œæˆ
                    profileChartInstance.destroy();
                }
                
                // æ–°ã—ã„ãƒãƒ£ãƒ¼ãƒˆã‚’ä½œæˆ
                profileChartInstance = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼', 'ã‚¹ãƒ‘ã‚¤ã‚·ãƒ¼', 'ãƒœãƒ‡ã‚£', 'ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼', 'ç”˜ã•', 'è¤‡é›‘ã•'],
                        datasets: datasets
                    },
                    options: chartOptions
                });
            }

            // ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã®é¸æŠ
            function selectWhisky(whisky) {
                selectedWhisky = whisky;
                
                // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’æ›´æ–°
                updateProfileChart(whisky.taste_profile, whisky.name);
                
                // è’¸ç•™æ‰€æƒ…å ±ã‚’æ›´æ–°
                updateDistilleryInfo(whisky);
                
                // ãƒãƒ£ãƒ¼ãƒˆãƒ‘ãƒãƒ«ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                const chartPanel = document.getElementById('chartPanel');
                if (chartPanel) {
                    chartPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }

            // è’¸ç•™æ‰€æƒ…å ±ã®æ›´æ–°
            function updateDistilleryInfo(whisky) {
                if (!whisky || !whisky.distillery) return;
                
                const distillery = whisky.distillery;
                
                // è’¸ç•™æ‰€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹
                document.getElementById('distillerySection').classList.add('active');
                
                // æƒ…å ±ã‚’æ›´æ–°
                document.getElementById('distilleryName').textContent = distillery.name;
                document.getElementById('distilleryRegion').textContent = distillery.region;
                document.getElementById('distilleryFounded').textContent = distillery.founded;
                document.getElementById('distilleryOwner').textContent = distillery.owner;
                document.getElementById('distilleryDescription').textContent = distillery.description;
                
                // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«å¿œã˜ãŸã‚¹ã‚¿ã‚¤ãƒ«
                const statusElement = document.getElementById('distilleryStatus');
                statusElement.textContent = distillery.status;
                statusElement.className = '';
                
                if (distillery.status === 'ç¨¼åƒä¸­') {
                    statusElement.classList.add('status-active');
                } else if (distillery.status === 'é–‰é–') {
                    statusElement.classList.add('status-closed');
                } else {
                    statusElement.classList.add('status-unknown');
                }
                
                // ãƒãƒƒãƒ—ã®æ›´æ–°
                updateDistilleryMap(distillery);
            }

            // è’¸ç•™æ‰€ãƒãƒƒãƒ—ã®æ›´æ–°
            function updateDistilleryMap(distillery) {
                if (!distillery || !distillery.lat || !distillery.lng) return;
                
                // ãƒãƒƒãƒ—ã®åˆæœŸåŒ–ï¼ˆåˆå›ã®ã¿ï¼‰
                if (!map) {
                    map = L.map('distilleryMap').setView([distillery.lat, distillery.lng], 8);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                        attribution: 'Â© OpenStreetMap contributors Â© CARTO',
                        subdomains: 'abcd',
                        maxZoom: 19
                    }).addTo(map);
                }
                
                // ãƒãƒƒãƒ—ä½ç½®ã®æ›´æ–°
                map.setView([distillery.lat, distillery.lng], 10);
                
                // ãƒãƒ¼ã‚«ãƒ¼ã®æ›´æ–°
                if (marker) {
                    marker.remove();
                }
                
                // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³ã®ä½œæˆ
                const distilleryIcon = L.divIcon({
                    html: `<div style="background-color: #4ecdc4; width: 14px; height: 14px; border-radius: 50%; border: 3px solid rgba(255, 255, 255, 0.8); box-shadow: 0 0 10px rgba(78, 205, 196, 0.7);"></div>`,
                    className: 'distillery-marker',
                    iconSize: [20, 20],
                    iconAnchor: [10, 10]
                });
                
                // ãƒãƒ¼ã‚«ãƒ¼ã®è¿½åŠ 
                marker = L.marker([distillery.lat, distillery.lng], {
                    icon: distilleryIcon
                }).addTo(map);
                
                // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¿½åŠ 
                marker.bindPopup(`
                    <div style="font-weight: bold; color: #4ecdc4; margin-bottom: 5px;">${distillery.name}</div>
                    <div style="font-size: 0.9em;">${distillery.region}</div>
                `);
            }

            // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º
            function displayLocalRecommendations() {
                const container = document.getElementById('recommendationContent');
                if (!container) return;
                
                container.innerHTML = '';
                
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®å–å¾—
                const userProfile = getUserProfile();
                
                // ä¾¡æ ¼å¸¯ã®å–å¾—
                const minPrice = document.getElementById('minPrice').value * 1000;
                const maxPrice = document.getElementById('maxPrice').value * 1000;
                
                // ä¾¡æ ¼è¡¨ç¤ºã®æ›´æ–°
                document.getElementById('priceRange').textContent = `Â¥${formatPrice(minPrice)} - Â¥${formatPrice(maxPrice)}`;
                
                // å‘³ã®å¥½ã¿ã®èª¬æ˜ã‚’æ›´æ–°
                updateTasteDescription(userProfile);
                
                // ç°¡æ˜“ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®é¡ä¼¼åº¦ã‚’è¨ˆç®—
                const scoredWhiskies = whiskies.filter(whisky => {
                    return whisky.price >= minPrice && whisky.price <= maxPrice;
                }).map(whisky => {
                    // å„è¦ç´ ã®å·®ã®äºŒä¹—å’Œã®å¹³æ–¹æ ¹ã‚’é¡ä¼¼åº¦ã‚¹ã‚³ã‚¢ã¨ã™ã‚‹ï¼ˆä½ã„ã»ã©é¡ä¼¼ï¼‰
                    const profile = whisky.taste_profile;
                    const score = Math.sqrt(
                        Math.pow(profile.fruity - userProfile.fruity, 2) +
                        Math.pow(profile.spicy - userProfile.spicy, 2) +
                        Math.pow(profile.body - userProfile.body, 2) +
                        Math.pow(profile.smoky - userProfile.smoky, 2) +
                        Math.pow(profile.sweetness - userProfile.sweetness, 2) +
                        Math.pow(profile.complexity - userProfile.complexity, 2)
                    );
                    
                    return {
                        whisky: whisky,
                        score: score
                    };
                });
                
                // ã‚¹ã‚³ã‚¢ã§ã‚½ãƒ¼ãƒˆï¼ˆä½ã„ã»ã©é¡ä¼¼åº¦ãŒé«˜ã„ï¼‰
                scoredWhiskies.sort((a, b) => a.score - b.score);
                
                // ä¸Šä½3ã¤ã®æ¨å¥¨éŠ˜æŸ„ã‚’å–å¾—
                const recommendations = scoredWhiskies.slice(0, 3);
                
                // UIè¡¨ç¤ºç”¨ã«ã‚¿ã‚°ä»˜ã‘
                const featuredWhisky = recommendations[0]?.whisky;
                
                // æ¨å¥¨éŠ˜æŸ„ã®è¡¨ç¤º
                recommendations.forEach((item, index) => {
                    const whisky = item.whisky;
                    const isFeatured = index === 0;
                    
                    const whiskeyCard = document.createElement('div');
                    whiskeyCard.className = `whisky-card ${isFeatured ? 'featured' : ''} mb-4`;
                    
                    if (isFeatured) {
                        const featuredLabel = document.createElement('div');
                        featuredLabel.className = 'featured-label';
                        featuredLabel.textContent = 'ãƒˆãƒƒãƒ—æ¨è–¦';
                        whiskeyCard.appendChild(featuredLabel);
                    }
                    
                    whiskeyCard.innerHTML = `
                        <h3 class="text-xl font-bold mb-2">${whisky.name}</h3>
                        <div class="text-sm text-gray-300 mb-2">
                            <span class="mr-4">åœ°åŸŸ: ${whisky.region}</span>
                            <span>ä¾¡æ ¼: Â¥${formatPrice(whisky.price)}</span>
                        </div>
                        <p class="text-sm">${whisky.description}</p>
                    `;
                    
                    whiskeyCard.addEventListener('click', function() {
                        // é¸æŠçŠ¶æ…‹ã‚’æ›´æ–°
                        document.querySelectorAll('.whisky-card').forEach(card => {
                            card.classList.remove('selected');
                        });
                        whiskeyCard.classList.add('selected');
                        // ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ã‚’é¸æŠ
                        selectWhisky(whisky);
                    });
                    
                    container.appendChild(whiskeyCard);
                });
                
                // ã‚¦ã‚£ã‚¹ã‚­ãƒ¼æ•°ã®è¡¨ç¤ºã‚’æ›´æ–°
                document.getElementById('whiskyCount').textContent = whiskies.length;
                document.getElementById('totalWhiskies').textContent = whiskies.length;
                
                // ãƒ¦ãƒ‹ãƒ¼ã‚¯åœ°åŸŸæ•°ã®è¡¨ç¤ºã‚’æ›´æ–°
                const uniqueRegions = new Set(whiskies.map(w => w.region)).size;
                document.getElementById('uniqueRegions').textContent = uniqueRegions;
                
                // çµæœè¡¨ç¤ºã‚³ãƒ³ãƒ†ãƒŠã‚’è¡¨ç¤º
                document.getElementById('splitLayoutContainer').style.display = 'grid';
            }

            // å‘³ã®å¥½ã¿ã®èª¬æ˜ã‚’æ›´æ–°
            function updateTasteDescription(userProfile) {
                let tasteDesc = '';
                let complexityDesc = '';
                
                // åŸºæœ¬çš„ãªå‘³ã®å‚¾å‘
                if (userProfile.fruity >= 4 && userProfile.smoky <= 2) {
                    tasteDesc = 'ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ã§è»½ã‚„ã‹ãª';
                } else if (userProfile.smoky >= 4 && userProfile.fruity <= 2) {
                    tasteDesc = 'ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼ã§å¼·çƒˆãª';
                } else if (userProfile.body >= 4) {
                    tasteDesc = 'è±Šã‹ãªãƒœãƒ‡ã‚£ã®';
                } else {
                    tasteDesc = 'ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸ';
                }
                
                // è¤‡é›‘ã•ã®å¥½ã¿
                if (userProfile.complexity >= 4 && userProfile.sweetness >= 4) {
                    complexityDesc = 'ç”˜ãè¤‡é›‘ãªé¢¨å‘³ã‚’å¥½ã‚€';
                } else if (userProfile.complexity >= 4) {
                    complexityDesc = 'ç†Ÿæˆã•ã‚ŒãŸè¤‡é›‘ãªé¢¨å‘³ã‚’å¥½ã‚€';
                } else if (userProfile.complexity <= 2) {
                    complexityDesc = 'ã™ã£ãã‚Šã¨ã—ãŸã‚·ãƒ³ãƒ—ãƒ«ãªé¢¨å‘³ã‚’å¥½ã‚€';
                } else if (userProfile.sweetness >= 4) {
                    complexityDesc = 'ã¾ã‚ã‚„ã‹ã§ç”˜ã¿ã®ã‚ã‚‹é¢¨å‘³ã‚’å¥½ã‚€';
                } else {
                    complexityDesc = 'ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„è¤‡é›‘ã•ã‚’å¥½ã‚€';
                }
                
                document.getElementById('tasteDescription').textContent = tasteDesc;
                document.getElementById('complexityDescription').textContent = complexityDesc;
            }

            // ä¾¡æ ¼ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰
            function formatPrice(price) {
                return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
            function setupEventListeners() {
                // ä¾¡æ ¼ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ - é€£å‹•æ©Ÿèƒ½è¿½åŠ 
                document.getElementById('minPrice').addEventListener('input', function() {
                    const minVal = parseInt(this.value);
                    const maxVal = parseInt(document.getElementById('maxPrice').value);
                    
                    // ä¸‹é™ãŒä¸Šé™ã‚’è¶…ãˆãªã„ã‚ˆã†ã«åˆ¶é™
                    if (minVal > maxVal) {
                        this.value = maxVal;
                        document.getElementById('minPriceDisplay').textContent = `Â¥${formatPrice(maxVal * 1000)}`;
                    } else {
                        document.getElementById('minPriceDisplay').textContent = `Â¥${formatPrice(minVal * 1000)}`;
                    }
                });
                
                document.getElementById('maxPrice').addEventListener('input', function() {
                    const maxVal = parseInt(this.value);
                    const minVal = parseInt(document.getElementById('minPrice').value);
                    
                    // ä¸Šé™ãŒä¸‹é™ã‚’ä¸‹å›ã‚‰ãªã„ã‚ˆã†ã«åˆ¶é™
                    if (maxVal < minVal) {
                        this.value = minVal;
                        document.getElementById('maxPriceDisplay').textContent = `Â¥${formatPrice(minVal * 1000)}`;
                    } else {
                        document.getElementById('maxPriceDisplay').textContent = `Â¥${formatPrice(maxVal * 1000)}`;
                    }
                });
                
                // ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ãƒœã‚¿ãƒ³
                document.getElementById('getRecommendation').addEventListener('click', function() {
                    // ãƒ­ãƒ¼ãƒ‰è¡¨ç¤º
                    document.getElementById('loadingIndicator').style.display = 'block';
                    
                    // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼è¡¨ç¤º
                    const progressContainer = document.getElementById('progressContainer');
                    progressContainer.style.display = 'block';
                    
                    const progressFill = document.getElementById('progressFill');
                    const progressText = document.getElementById('progressText');
                    const progressPercentage = document.getElementById('progressPercentage');
                    
                    let progress = 0;
                    const interval = setInterval(function() {
                        progress += 5;
                        if (progress > 100) {
                            clearInterval(interval);
                            
                            // ãƒ­ãƒ¼ãƒ‰è¡¨ç¤ºã‚’éè¡¨ç¤º
                            document.getElementById('loadingIndicator').style.display = 'none';
                            document.getElementById('progressContainer').style.display = 'none';
                            
                            // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º
                            displayLocalRecommendations();
                            
                            // ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ«ã«è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                            setTimeout(() => {
                                const recommendationsPanel = document.getElementById('recommendationsPanel');
                                if (recommendationsPanel) {
                                    recommendationsPanel.scrollIntoView({ behavior: 'smooth' });
                                }
                            }, 500);
                        } else {
                            progressFill.style.width = `${progress}%`;
                            progressPercentage.textContent = `${progress}%`;
                            
                            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ›´æ–°
                            if (progress < 30) {
                                progressText.textContent = 'å‘³è¦šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†æä¸­...';
                            } else if (progress < 60) {
                                progressText.textContent = 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å€™è£œã‚’æŠ½å‡ºä¸­...';
                            } else if (progress < 90) {
                                progressText.textContent = 'æœ€é©ãªçµ„ã¿åˆã‚ã›ã‚’è¨ˆç®—ä¸­...';
                            } else {
                                progressText.textContent = 'çµæœã‚’ç”Ÿæˆä¸­...';
                            }
                        }
                    }, 50);
                });
                
                // ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒœã‚¿ãƒ³
                document.getElementById('refreshRecommendation').addEventListener('click', function() {
                    // åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
                    document.getElementById('minPrice').value = 5;
                    document.getElementById('maxPrice').value = 50;
                    document.getElementById('minPriceDisplay').textContent = 'Â¥5,000';
                    document.getElementById('maxPriceDisplay').textContent = 'Â¥50,000';
                    
                    // ãƒ†ã‚¤ã‚¹ãƒˆãƒ‰ãƒƒãƒˆã‚’ä¸­å¤®ã«æˆ»ã™
                    const dot1 = document.getElementById('tasteDot1');
                    const dot2 = document.getElementById('tasteDot2');
                    
                    dot1.style.left = '50%';
                    dot1.style.top = '50%';
                    dot2.style.left = '50%';
                    dot2.style.top = '50%';
                    
                    document.getElementById('coordinates1').textContent = 'åº§æ¨™: X: 0.50, Y: 0.50';
                    document.getElementById('coordinates2').textContent = 'åº§æ¨™: X: 0.50, Y: 0.50';
                    
                    // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
                    updateProfileChart(getUserProfile());
                    
                    // è’¸ç•™æ‰€æƒ…å ±ã‚’éè¡¨ç¤º
                    document.getElementById('distillerySection').classList.remove('active');
                    
                    // çµæœè¡¨ç¤ºã‚³ãƒ³ãƒ†ãƒŠã‚’éè¡¨ç¤º
                    document.getElementById('splitLayoutContainer').style.display = 'none';
                });
                
                // åˆ¥ã®ææ¡ˆãƒœã‚¿ãƒ³
                document.getElementById('getAnotherRecommendation').addEventListener('click', function() {
                    // ç°¡æ˜“çš„ãªãƒ©ãƒ³ãƒ€ãƒ è¦ç´ ã‚’åŠ ãˆã¦å†è¡¨ç¤º
                    displayLocalRecommendations();
                });
                
                // è³ªå•ä¾‹ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
                document.querySelectorAll('.question-example').forEach(item => {
                    item.addEventListener('click', function() {
                        const question = this.getAttribute('data-question');
                        document.getElementById('chatInput').value = question;
                    });
                });
                
                // è³ªå•é€ä¿¡ãƒœã‚¿ãƒ³
                document.getElementById('sendChatBtn').addEventListener('click', function() {
                    const input = document.getElementById('chatInput');
                    const question = input.value.trim();
                    
                    if (question) {
                        // ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’è¡¨ç¤º
                        const chatHistory = document.getElementById('chatHistory');
                        chatHistory.style.display = 'block';
                        
                        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¿½åŠ 
                        const userMessage = document.createElement('div');
                        userMessage.className = 'chat-message user-message';
                        userMessage.textContent = question;
                        chatHistory.appendChild(userMessage);
                        
                        // ç°¡æ˜“çš„ãªAIå¿œç­”ï¼ˆå®Ÿéš›ã«ã¯APIãªã©ã‚’ä½¿ç”¨ï¼‰
                        setTimeout(() => {
                            const aiMessage = document.createElement('div');
                            aiMessage.className = 'chat-message ai-message';
                            aiMessage.textContent = getSimpleResponse(question);
                            chatHistory.appendChild(aiMessage);
                            
                            // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ€ä¸‹éƒ¨ã«
                            chatHistory.scrollTop = chatHistory.scrollHeight;
                        }, 1000);
                        
                        // å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
                        input.value = '';
                    }
                });
                
                // éŸ³å£°å…¥åŠ›ãƒœã‚¿ãƒ³ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¢ãƒƒã‚¯ï¼‰
                document.getElementById('voiceInputBtn').addEventListener('click', function() {
                    const btn = this;
                    
                    if (btn.classList.contains('recording')) {
                        btn.classList.remove('recording');
                    } else {
                        btn.classList.add('recording');
                        
                        // ãƒ¢ãƒƒã‚¯ - 3ç§’å¾Œã«éŒ²éŸ³å®Œäº†ã‚’æƒ³å®š
                        setTimeout(() => {
                            btn.classList.remove('recording');
                            document.getElementById('chatInput').value = "éŸ³å£°å…¥åŠ›ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚­ã‚¹ãƒˆã§ã™";
                        }, 3000);
                    }
                });
                
                // ãƒãƒ£ãƒƒãƒˆå…¥åŠ›æ¬„ã®Enterã‚­ãƒ¼å‡¦ç†
                document.getElementById('chatInput').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        document.getElementById('sendChatBtn').click();
                    }
                });
            }

            // ç°¡æ˜“çš„ãªãƒãƒ£ãƒƒãƒˆå¿œç­”ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
            function getSimpleResponse(question) {
                if (question.includes('ã‚¿ãƒªã‚¹ã‚«ãƒ¼')) {
                    return "ã‚¿ãƒªã‚¹ã‚«ãƒ¼44å¹´ã¯ã€2018å¹´ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸéå¸¸ã«å¸Œå°‘ãªã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã§ã™ã€‚ã‚¢ã‚¤ãƒ«ãƒ»ã‚ªãƒ–ãƒ»ã‚¹ã‚«ã‚¤ã®è’¸ç•™æ‰€ã§è£½é€ ã•ã‚Œã€44å¹´ã®ç†Ÿæˆã‚’çµŒã¦ã„ã¾ã™ã€‚ç‰¹å¾´çš„ãªæµ·å¡©ã¨ç”˜ã¿ã®ãƒãƒ©ãƒ³ã‚¹ãŒçµ¶å¦™ã§ã€è¤‡é›‘ãªé¢¨å‘³ãŒæ¥½ã—ã‚ã¾ã™ã€‚ä¾¡æ ¼ã¯å¸Œå°‘æ€§ã‚’åæ˜ ã—ã¦80,400å††ã¨é«˜ä¾¡ã§ã™ãŒã€ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼ã‚„æ„›å¥½å®¶ã«ã¨ã£ã¦ä¾¡å€¤ã‚ã‚‹ä¸€æœ¬ã§ã™ã€‚";
                } else if (question.includes('3000å††') && question.includes('ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼')) {
                    return "3000å††ä»¥ä¸‹ã§ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼ãªã‚¢ã‚¤ãƒ©å³¶ã®ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã¨ã—ã¦ã¯ã€ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒˆãƒ«ã®ã‚¢ã‚¤ãƒ©ãƒŸã‚¹ãƒˆãŒãŠã™ã™ã‚ã§ã™ã€‚æœ¬æ ¼çš„ãªã‚¢ã‚¤ãƒ©ãƒ¢ãƒ«ãƒˆã‚’ä½¿ç”¨ã—ãŸãƒ–ãƒ¬ãƒ³ãƒ‡ãƒƒãƒ‰ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã§ã€æ‰‹é ƒãªä¾¡æ ¼ãªãŒã‚‰ç‰¹å¾´çš„ãªãƒ”ãƒ¼ãƒˆã‚¹ãƒ¢ãƒ¼ã‚¯ã®é¢¨å‘³ãŒæ¥½ã—ã‚ã¾ã™ã€‚ã¾ãŸã€å­£ç¯€é™å®šã§å®‰å£²ã‚Šã•ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã‚¢ã‚¤ãƒªãƒ¼ã‚¯ãƒ»ãƒ¢ãƒ«ãƒˆã‚‚é¸æŠè‚¢ã®ä¸€ã¤ã§ã™ã€‚";
                } else if (question.includes('æ—¥æœ¬') && question.includes('ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼')) {
                    return "æ—¥æœ¬ã®ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãªã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã¨ã—ã¦ã€è»½äº•æ²¢è’¸ç•™æ‰€ã¯è¯ã‚„ã‹ã§ç¹Šç´°ãªãƒ•ãƒ«ãƒ¼ãƒ„ãƒãƒ¼ãƒˆãŒç‰¹å¾´ã§ã€ç‰¹ã«ã‚·ã‚§ãƒªãƒ¼æ¨½ç†Ÿæˆã®ã‚‚ã®ã¯è¤‡é›‘ãªç”˜ã¿ãŒã‚ã‚Šã¾ã™ã€‚ä¸€æ–¹ã€é•·æ¿±è’¸ç•™æ‰€ã®ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã¯ã‚ˆã‚Šç¾ä»£çš„ã§ã€çˆ½ã‚„ã‹ãªæŸ‘æ©˜ç³»ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã¨è»½ã‚„ã‹ãªãƒœãƒ‡ã‚£ãŒé­…åŠ›ã§ã™ã€‚ã©ã¡ã‚‰ã‚‚æ—¥æœ¬çš„ãªç¹Šç´°ã•ã‚’æŒã¡ãªãŒã‚‰ã€ãã‚Œãã‚Œç‹¬è‡ªã®ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãªå€‹æ€§ã‚’è¡¨ç¾ã—ã¦ã„ã¾ã™ã€‚";
                } else if (question.includes('complexity') && question.includes('5ç‚¹')) {
                    return "5000å††å‰å¾Œã§complexity5ç‚¹ã®è¤‡é›‘ãªã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã¨ã—ã¦ã¯ã€ã‚°ãƒ¬ãƒ³ãƒ•ã‚¡ãƒ¼ã‚¯ãƒ©ã‚¹12å¹´ãŒãŠã™ã™ã‚ã§ã™ã€‚ã‚·ã‚§ãƒªãƒ¼æ¨½ç†Ÿæˆã«ã‚ˆã‚‹è¤‡é›‘ã•ã¨ã‚¹ãƒ‘ã‚¤ã‚¹æ„Ÿã€è±Šã‹ãªãƒ‰ãƒ©ã‚¤ãƒ•ãƒ«ãƒ¼ãƒ„ã®é¢¨å‘³ãŒç‰¹å¾´ã§ã€ä¾¡æ ¼ã«å¯¾ã—ã¦éå¸¸ã«é«˜ã„ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚’èª‡ã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚¢ãƒ¼ãƒ‰ãƒ™ãƒƒã‚°10å¹´ã‚‚åŒä¾¡æ ¼å¸¯ã§è¤‡é›‘ã•5ç‚¹ã«è¿‘ãã€ã‚¹ãƒ¢ãƒ¼ã‚­ãƒ¼ãªä¸­ã«ã‚‚å¤šå±¤çš„ãªé¢¨å‘³ãŒå±•é–‹ã™ã‚‹å‚‘ä½œã§ã™ã€‚";
                } else {
                    return "ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚‚ã†å°‘ã—å…·ä½“çš„ã«ãŠèãã—ãŸã„ã§ã™ã€‚ä¾‹ãˆã°ç‰¹å®šã®éŠ˜æŸ„ã€ç”£åœ°ã€ä¾¡æ ¼å¸¯ã€ã‚ã‚‹ã„ã¯å‘³ã®å¥½ã¿ã«ã¤ã„ã¦ãŠæ•™ãˆã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ";
                }
            }

            // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸåŒ–
            setupTasteMatrices();
            setupEventListeners();
            updateProfileChart(getUserProfile());
            
            // åˆæœŸå€¤ã¨ã—ã¦ã€ä¾¡æ ¼å¸¯ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤º
            document.getElementById('minPriceDisplay').textContent = `Â¥${formatPrice(parseInt(document.getElementById('minPrice').value) * 1000)}`;
            document.getElementById('maxPriceDisplay').textContent = `Â¥${formatPrice(parseInt(document.getElementById('maxPrice').value) * 1000)}`;
            
            // ã‚¦ã‚£ã‚¹ã‚­ãƒ¼æ•°ã®åˆæœŸè¡¨ç¤º
            document.getElementById('whiskyCount').textContent = whiskies.length;
            document.getElementById('totalWhiskies').textContent = whiskies.length;
            
            // ãƒ¦ãƒ‹ãƒ¼ã‚¯åœ°åŸŸæ•°ã®åˆæœŸè¡¨ç¤º
            const uniqueRegions = new Set(whiskies.map(w => w.region)).size;
            document.getElementById('uniqueRegions').textContent = uniqueRegions;
            
            // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒšãƒ¼ã‚¸ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒªãƒ³ã‚¯ã«ã‚¯ãƒ©ã‚¹è¿½åŠ 
            const currentPath = window.location.pathname;
            if (currentPath.includes('whisky_list.html')) {
                document.getElementById('listLink').classList.add('active');
            } else {
                document.getElementById('homeLink').classList.add('active');
            }
        });
    </script>


    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDnlibAxUVbmw6mSFK8xmbFUemGmN%2BkTk82682efYHf%2FDa8aVayhAJ%2BHlR1ks3i6YgnjaG12ONFvFXi5g8nPoEmTgvfCV0jnPwQQMcaKvtemsBmZfSfL6pr9tsmQ9RRT5DMVYHqxodeuDNFCO2A6oJVn7DVMGFjM19L%2F3jdQ09IQMJHS3ihFo3K5iQHlzsRQS8xyUulZAdcgVjn513RF%2Ft65VXwo2you1XUFhux%2FssUpC1PeucIXsQFVrDCa1Xls9Wcky5doHpadtAHzfmR017ZcSVqnumaQ7922DTp9v4KBeLsOwAABGgBkWxIWw0jD4LRiGPJjx9iY17ycAuu2uXOTKea2XSVSwRvMUI%2FvDviVvzKSXpT4brkaAL3x2n5rk1%2BGyH3IUa6%2FGBxx%2FoVQpnxX2zpSnXGYXdddmiFz8HNBoGXQ8pptR%2FFmQmlSxnGZ5M0YXug9emBXUgbq2Ff7%2F6IybhXcsN7wTOL43KzbqC30lDDontMywy81fPNUOQEXa7uPy0iGtJp2KOw7sn0BJ%2F7E%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDnlibAxUVbmw6mSFK8xmbFUemGmN+kTk82682efYHf/Da8aVayhAJ+HlR1ks3i6YgnjaG12ONFvFXi5g8nPoEmTgvfCV0jnPwQQMcaKvtemsBmZfSfL6pr9tsmQ9RRT5DMVYHqxodeuDNFCO2A6oJVn7DVMGFjM19L/3jdQ09IQMJHS3ihFo3K5iQHlzsRQS8xyUulZAdcgVjn513RF/t65VXwo2you1XUFhux/ssUpC1PeucIXsQFVrDCa1Xls9Wcky5doHpadtAHzfmR017ZcSVqnumaQ7922DTp9v4KBeLsOwAABGgBkWxIWw0jD4LRiGPJjx9iY17ycAuu2uXOTKea2XSVSwRvMUI/vDviVvzKSXpT4brkaAL3x2n5rk1+GyH3IUa6/GBxx/oVQpnxX2zpSnXGYXdddmiFz8HNBoGXQ8pptR/FmQmlSxnGZ5M0YXug9emBXUgbq2Ff7/6IybhXcsN7wTOL43KzbqC30lDDontMywy81fPNUOQEXa7uPy0iGtJp2KOw7sn0BJ/7E=";
    </script>
    
    <script id="html_notice_dialog_script" src="./index_files/notice_dialog.js.ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰"></script>
    </body></html>